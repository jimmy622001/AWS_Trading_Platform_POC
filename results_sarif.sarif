{"$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/main/sarif-2.1/schema/sarif-schema-2.1.0.json", "version": "2.1.0", "runs": [{"tool": {"driver": {"name": "Checkov", "version": "3.2.485", "informationUri": "https://checkov.io", "rules": [{"id": "CKV_AWS_26", "name": "Ensure all data stored in the SNS topic is encrypted", "shortDescription": {"text": "Ensure all data stored in the SNS topic is encrypted"}, "fullDescription": {"text": "Ensure all data stored in the SNS topic is encrypted"}, "help": {"text": "Ensure all data stored in the SNS topic is encrypted\nResource: module.disaster_recovery.aws_sns_topic.dr_alerts"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-15"}, {"id": "CKV_AWS_130", "name": "Ensure VPC subnets do not assign public IP by default", "shortDescription": {"text": "Ensure VPC subnets do not assign public IP by default"}, "fullDescription": {"text": "Ensure VPC subnets do not assign public IP by default"}, "help": {"text": "Ensure VPC subnets do not assign public IP by default\nResource: module.disaster_recovery.aws_subnet.dr_public"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default"}, {"id": "CKV_AWS_23", "name": "Ensure every security group and rule has a description", "shortDescription": {"text": "Ensure every security group and rule has a description"}, "fullDescription": {"text": "Ensure every security group and rule has a description"}, "help": {"text": "Ensure every security group and rule has a description\nResource: module.disaster_recovery.aws_security_group.dr_rds"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31"}, {"id": "CKV_AWS_382", "name": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "shortDescription": {"text": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1"}, "fullDescription": {"text": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1"}, "help": {"text": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1\nResource: module.disaster_recovery.aws_security_group.dr_rds"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382"}, {"id": "CKV_AWS_129", "name": "Ensure that respective logs of Amazon Relational Database Service (Amazon RDS) are enabled", "shortDescription": {"text": "Ensure that respective logs of Amazon Relational Database Service (Amazon RDS) are enabled"}, "fullDescription": {"text": "Ensure that respective logs of Amazon Relational Database Service (Amazon RDS) are enabled"}, "help": {"text": "Ensure that respective logs of Amazon Relational Database Service (Amazon RDS) are enabled\nResource: module.disaster_recovery.aws_db_instance.dr_replica"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-that-respective-logs-of-amazon-relational-database-service-amazon-rds-are-enabled"}, {"id": "CKV_AWS_16", "name": "Ensure all data stored in the RDS is securely encrypted at rest", "shortDescription": {"text": "Ensure all data stored in the RDS is securely encrypted at rest"}, "fullDescription": {"text": "Ensure all data stored in the RDS is securely encrypted at rest"}, "help": {"text": "Ensure all data stored in the RDS is securely encrypted at rest\nResource: module.disaster_recovery.aws_db_instance.dr_replica"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-4"}, {"id": "CKV_AWS_118", "name": "Ensure that enhanced monitoring is enabled for Amazon RDS instances", "shortDescription": {"text": "Ensure that enhanced monitoring is enabled for Amazon RDS instances"}, "fullDescription": {"text": "Ensure that enhanced monitoring is enabled for Amazon RDS instances"}, "help": {"text": "Ensure that enhanced monitoring is enabled for Amazon RDS instances\nResource: module.disaster_recovery.aws_db_instance.dr_replica"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/ensure-that-enhanced-monitoring-is-enabled-for-amazon-rds-instances"}, {"id": "CKV_AWS_293", "name": "Ensure that AWS database instances have deletion protection enabled", "shortDescription": {"text": "Ensure that AWS database instances have deletion protection enabled"}, "fullDescription": {"text": "Ensure that AWS database instances have deletion protection enabled"}, "help": {"text": "Ensure that AWS database instances have deletion protection enabled\nResource: module.disaster_recovery.aws_db_instance.dr_replica"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-293"}, {"id": "CKV_AWS_353", "name": "Ensure that RDS instances have performance insights enabled", "shortDescription": {"text": "Ensure that RDS instances have performance insights enabled"}, "fullDescription": {"text": "Ensure that RDS instances have performance insights enabled"}, "help": {"text": "Ensure that RDS instances have performance insights enabled\nResource: module.disaster_recovery.aws_db_instance.dr_replica"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-353"}, {"id": "CKV_AWS_157", "name": "Ensure that RDS instances have Multi-AZ enabled", "shortDescription": {"text": "Ensure that RDS instances have Multi-AZ enabled"}, "fullDescription": {"text": "Ensure that RDS instances have Multi-AZ enabled"}, "help": {"text": "Ensure that RDS instances have Multi-AZ enabled\nResource: module.disaster_recovery.aws_db_instance.dr_replica"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-73"}, {"id": "CKV_AWS_338", "name": "Ensure CloudWatch log groups retains logs for at least 1 year", "shortDescription": {"text": "Ensure CloudWatch log groups retains logs for at least 1 year"}, "fullDescription": {"text": "Ensure CloudWatch log groups retains logs for at least 1 year"}, "help": {"text": "Ensure CloudWatch log groups retains logs for at least 1 year\nResource: module.disaster_recovery.aws_cloudwatch_log_group.dr_eks"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-338"}, {"id": "CKV_AWS_37", "name": "Ensure Amazon EKS control plane logging is enabled for all log types", "shortDescription": {"text": "Ensure Amazon EKS control plane logging is enabled for all log types"}, "fullDescription": {"text": "Ensure Amazon EKS control plane logging is enabled for all log types"}, "help": {"text": "Ensure Amazon EKS control plane logging is enabled for all log types\nResource: module.disaster_recovery.aws_eks_cluster.dr"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-kubernetes-policies/bc-aws-kubernetes-4"}, {"id": "CKV_AWS_39", "name": "Ensure Amazon EKS public endpoint disabled", "shortDescription": {"text": "Ensure Amazon EKS public endpoint disabled"}, "fullDescription": {"text": "Ensure Amazon EKS public endpoint disabled"}, "help": {"text": "Ensure Amazon EKS public endpoint disabled\nResource: module.disaster_recovery.aws_eks_cluster.dr"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-kubernetes-policies/bc-aws-kubernetes-2"}, {"id": "CKV_AWS_38", "name": "Ensure Amazon EKS public endpoint not accessible to 0.0.0.0/0", "shortDescription": {"text": "Ensure Amazon EKS public endpoint not accessible to 0.0.0.0/0"}, "fullDescription": {"text": "Ensure Amazon EKS public endpoint not accessible to 0.0.0.0/0"}, "help": {"text": "Ensure Amazon EKS public endpoint not accessible to 0.0.0.0/0\nResource: module.disaster_recovery.aws_eks_cluster.dr"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-kubernetes-policies/bc-aws-kubernetes-1"}, {"id": "CKV_AWS_28", "name": "Ensure DynamoDB point in time recovery (backup) is enabled", "shortDescription": {"text": "Ensure DynamoDB point in time recovery (backup) is enabled"}, "fullDescription": {"text": "Ensure DynamoDB point in time recovery (backup) is enabled"}, "help": {"text": "Ensure DynamoDB point in time recovery (backup) is enabled\nResource: module.disaster_recovery.aws_dynamodb_table.primary"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-6"}, {"id": "CKV_AWS_119", "name": "Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK", "shortDescription": {"text": "Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK"}, "fullDescription": {"text": "Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK"}, "help": {"text": "Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK\nResource: module.disaster_recovery.aws_dynamodb_table.primary"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-52"}, {"id": "CKV_AWS_355", "name": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "shortDescription": {"text": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions"}, "fullDescription": {"text": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions"}, "help": {"text": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions\nResource: module.disaster_recovery.aws_iam_policy.dr_failover_lambda"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-355"}, {"id": "CKV_AWS_290", "name": "Ensure IAM policies does not allow write access without constraints", "shortDescription": {"text": "Ensure IAM policies does not allow write access without constraints"}, "fullDescription": {"text": "Ensure IAM policies does not allow write access without constraints"}, "help": {"text": "Ensure IAM policies does not allow write access without constraints\nResource: module.disaster_recovery.aws_iam_policy.dr_failover_lambda"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-290"}, {"id": "CKV_AWS_272", "name": "Ensure AWS Lambda function is configured to validate code-signing", "shortDescription": {"text": "Ensure AWS Lambda function is configured to validate code-signing"}, "fullDescription": {"text": "Ensure AWS Lambda function is configured to validate code-signing"}, "help": {"text": "Ensure AWS Lambda function is configured to validate code-signing\nResource: module.disaster_recovery.aws_lambda_function.dr_failover"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-272"}, {"id": "CKV_AWS_116", "name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "shortDescription": {"text": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)"}, "fullDescription": {"text": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)"}, "help": {"text": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)\nResource: module.disaster_recovery.aws_lambda_function.dr_failover"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq"}, {"id": "CKV_AWS_173", "name": "Check encryption settings for Lambda environmental variable", "shortDescription": {"text": "Check encryption settings for Lambda environmental variable"}, "fullDescription": {"text": "Check encryption settings for Lambda environmental variable"}, "help": {"text": "Check encryption settings for Lambda environmental variable\nResource: module.disaster_recovery.aws_lambda_function.dr_failover"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5"}, {"id": "CKV_AWS_115", "name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "shortDescription": {"text": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit"}, "fullDescription": {"text": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit"}, "help": {"text": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit\nResource: module.disaster_recovery.aws_lambda_function.dr_failover"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit"}, {"id": "CKV_AWS_117", "name": "Ensure that AWS Lambda function is configured inside a VPC", "shortDescription": {"text": "Ensure that AWS Lambda function is configured inside a VPC"}, "fullDescription": {"text": "Ensure that AWS Lambda function is configured inside a VPC"}, "help": {"text": "Ensure that AWS Lambda function is configured inside a VPC\nResource: module.disaster_recovery.aws_lambda_function.dr_failover"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1"}, {"id": "CKV_AWS_50", "name": "X-Ray tracing is enabled for Lambda", "shortDescription": {"text": "X-Ray tracing is enabled for Lambda"}, "fullDescription": {"text": "X-Ray tracing is enabled for Lambda"}, "help": {"text": "X-Ray tracing is enabled for Lambda\nResource: module.disaster_recovery.aws_lambda_function.dr_failover"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-4"}, {"id": "CKV_AWS_158", "name": "Ensure that CloudWatch Log Group is encrypted by KMS", "shortDescription": {"text": "Ensure that CloudWatch Log Group is encrypted by KMS"}, "fullDescription": {"text": "Ensure that CloudWatch Log Group is encrypted by KMS"}, "help": {"text": "Ensure that CloudWatch Log Group is encrypted by KMS\nResource: module.disaster_recovery.aws_cloudwatch_log_group.sync_sizes"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms"}, {"id": "CKV_AWS_252", "name": "Ensure CloudTrail defines an SNS Topic", "shortDescription": {"text": "Ensure CloudTrail defines an SNS Topic"}, "fullDescription": {"text": "Ensure CloudTrail defines an SNS Topic"}, "help": {"text": "Ensure CloudTrail defines an SNS Topic\nResource: module.monitoring.aws_cloudtrail.main"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-cloudtrail-defines-an-sns-topic"}, {"id": "CKV_AWS_35", "name": "Ensure CloudTrail logs are encrypted at rest using KMS CMKs", "shortDescription": {"text": "Ensure CloudTrail logs are encrypted at rest using KMS CMKs"}, "fullDescription": {"text": "Ensure CloudTrail logs are encrypted at rest using KMS CMKs"}, "help": {"text": "Ensure CloudTrail logs are encrypted at rest using KMS CMKs\nResource: module.monitoring.aws_cloudtrail.main"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-7"}, {"id": "CKV_AWS_36", "name": "Ensure CloudTrail log file validation is enabled", "shortDescription": {"text": "Ensure CloudTrail log file validation is enabled"}, "fullDescription": {"text": "Ensure CloudTrail log file validation is enabled"}, "help": {"text": "Ensure CloudTrail log file validation is enabled\nResource: module.monitoring.aws_cloudtrail.main"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-2"}, {"id": "CKV_AWS_67", "name": "Ensure CloudTrail is enabled in all Regions", "shortDescription": {"text": "Ensure CloudTrail is enabled in all Regions"}, "fullDescription": {"text": "Ensure CloudTrail is enabled in all Regions"}, "help": {"text": "Ensure CloudTrail is enabled in all Regions\nResource: module.monitoring.aws_cloudtrail.main"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-1"}, {"id": "CKV_AWS_184", "name": "Ensure resource is encrypted by KMS using a customer managed Key (CMK)", "shortDescription": {"text": "Ensure resource is encrypted by KMS using a customer managed Key (CMK)"}, "fullDescription": {"text": "Ensure resource is encrypted by KMS using a customer managed Key (CMK)"}, "help": {"text": "Ensure resource is encrypted by KMS using a customer managed Key (CMK)\nResource: module.observability.aws_efs_file_system.observability"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-104"}, {"id": "CKV_AWS_149", "name": "Ensure that Secrets Manager secret is encrypted using KMS CMK", "shortDescription": {"text": "Ensure that Secrets Manager secret is encrypted using KMS CMK"}, "fullDescription": {"text": "Ensure that Secrets Manager secret is encrypted using KMS CMK"}, "help": {"text": "Ensure that Secrets Manager secret is encrypted using KMS CMK\nResource: module.secrets.aws_secretsmanager_secret.rancher_password"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-secrets-manager-secret-is-encrypted-using-kms"}, {"id": "CKV_AWS_260", "name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "shortDescription": {"text": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80"}, "fullDescription": {"text": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80"}, "help": {"text": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80\nResource: module.security.aws_security_group.web"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80"}, {"id": "CKV_AWS_7", "name": "Ensure rotation for customer created CMKs is enabled", "shortDescription": {"text": "Ensure rotation for customer created CMKs is enabled"}, "fullDescription": {"text": "Ensure rotation for customer created CMKs is enabled"}, "help": {"text": "Ensure rotation for customer created CMKs is enabled\nResource: module.security.aws_kms_key.main"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-8"}, {"id": "CKV_AWS_363", "name": "Ensure Lambda Runtime is not deprecated", "shortDescription": {"text": "Ensure Lambda Runtime is not deprecated"}, "fullDescription": {"text": "Ensure Lambda Runtime is not deprecated"}, "help": {"text": "Ensure Lambda Runtime is not deprecated\nResource: module.serverless.aws_lambda_function.main"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-363"}, {"id": "CKV_AWS_237", "name": "Ensure Create before destroy for API Gateway", "shortDescription": {"text": "Ensure Create before destroy for API Gateway"}, "fullDescription": {"text": "Ensure Create before destroy for API Gateway"}, "help": {"text": "Ensure Create before destroy for API Gateway\nResource: module.serverless.aws_api_gateway_rest_api.main"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-api-gateway-enables-create-before-destroy"}, {"id": "CKV_AWS_59", "name": "Ensure there is no open access to back-end resources through API", "shortDescription": {"text": "Ensure there is no open access to back-end resources through API"}, "fullDescription": {"text": "Ensure there is no open access to back-end resources through API"}, "help": {"text": "Ensure there is no open access to back-end resources through API\nResource: module.serverless.aws_api_gateway_method.proxy"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-6-api-gateway-authorizer-set"}, {"id": "CKV_AWS_217", "name": "Ensure Create before destroy for API deployments", "shortDescription": {"text": "Ensure Create before destroy for API deployments"}, "fullDescription": {"text": "Ensure Create before destroy for API deployments"}, "help": {"text": "Ensure Create before destroy for API deployments\nResource: module.serverless.aws_api_gateway_deployment.main"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-api-deployments-enable-create-before-destroy"}, {"id": "CKV_AWS_76", "name": "Ensure API Gateway has Access Logging enabled", "shortDescription": {"text": "Ensure API Gateway has Access Logging enabled"}, "fullDescription": {"text": "Ensure API Gateway has Access Logging enabled"}, "help": {"text": "Ensure API Gateway has Access Logging enabled\nResource: module.serverless.aws_api_gateway_stage.main"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-17"}, {"id": "CKV_AWS_120", "name": "Ensure API Gateway caching is enabled", "shortDescription": {"text": "Ensure API Gateway caching is enabled"}, "fullDescription": {"text": "Ensure API Gateway caching is enabled"}, "help": {"text": "Ensure API Gateway caching is enabled\nResource: module.serverless.aws_api_gateway_stage.main"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-api-gateway-caching-is-enabled"}, {"id": "CKV_AWS_73", "name": "Ensure API Gateway has X-Ray Tracing enabled", "shortDescription": {"text": "Ensure API Gateway has X-Ray Tracing enabled"}, "fullDescription": {"text": "Ensure API Gateway has X-Ray Tracing enabled"}, "help": {"text": "Ensure API Gateway has X-Ray Tracing enabled\nResource: module.serverless.aws_api_gateway_stage.main"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-15"}, {"id": "CKV2_AWS_51", "name": "Ensure AWS API Gateway endpoints uses client certificate authentication", "shortDescription": {"text": "Ensure AWS API Gateway endpoints uses client certificate authentication"}, "fullDescription": {"text": "Ensure AWS API Gateway endpoints uses client certificate authentication"}, "help": {"text": "Ensure AWS API Gateway endpoints uses client certificate authentication\nResource: module.serverless.aws_api_gateway_stage.main"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-51"}, {"id": "CKV2_AWS_53", "name": "Ensure AWS API gateway request is validated", "shortDescription": {"text": "Ensure AWS API gateway request is validated"}, "fullDescription": {"text": "Ensure AWS API gateway request is validated"}, "help": {"text": "Ensure AWS API gateway request is validated\nResource: module.serverless.aws_api_gateway_method.proxy"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-53"}, {"id": "CKV2_AWS_4", "name": "Ensure API Gateway stage have logging level defined as appropriate", "shortDescription": {"text": "Ensure API Gateway stage have logging level defined as appropriate"}, "fullDescription": {"text": "Ensure API Gateway stage have logging level defined as appropriate"}, "help": {"text": "Ensure API Gateway stage have logging level defined as appropriate\nResource: module.serverless.aws_api_gateway_stage.main"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/ensure-api-gateway-stage-have-logging-level-defined-as-appropiate"}, {"id": "CKV2_AWS_29", "name": "Ensure public API gateway are protected by WAF", "shortDescription": {"text": "Ensure public API gateway are protected by WAF"}, "fullDescription": {"text": "Ensure public API gateway are protected by WAF"}, "help": {"text": "Ensure public API gateway are protected by WAF\nResource: module.serverless.aws_api_gateway_stage.main"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-public-api-gateway-are-protected-by-waf"}, {"id": "CKV2_AWS_37", "name": "Ensure CodeCommit associates an approval rule", "shortDescription": {"text": "Ensure CodeCommit associates an approval rule"}, "fullDescription": {"text": "Ensure CodeCommit associates an approval rule"}, "help": {"text": "Ensure CodeCommit associates an approval rule\nResource: module.cicd.aws_codecommit_repository.main"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-codecommit-is-associated-with-an-approval-rule"}, {"id": "CKV2_AWS_18", "name": "Ensure that Elastic File System (Amazon EFS) file systems are added in the backup plans of AWS Backup", "shortDescription": {"text": "Ensure that Elastic File System (Amazon EFS) file systems are added in the backup plans of AWS Backup"}, "fullDescription": {"text": "Ensure that Elastic File System (Amazon EFS) file systems are added in the backup plans of AWS Backup"}, "help": {"text": "Ensure that Elastic File System (Amazon EFS) file systems are added in the backup plans of AWS Backup\nResource: module.observability.aws_efs_file_system.observability"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-elastic-file-system-amazon-efs-file-systems-are-added-in-the-backup-plans-of-aws-backup"}, {"id": "CKV2_AWS_10", "name": "Ensure CloudTrail trails are integrated with CloudWatch Logs", "shortDescription": {"text": "Ensure CloudTrail trails are integrated with CloudWatch Logs"}, "fullDescription": {"text": "Ensure CloudTrail trails are integrated with CloudWatch Logs"}, "help": {"text": "Ensure CloudTrail trails are integrated with CloudWatch Logs\nResource: module.monitoring.aws_cloudtrail.main"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/ensure-cloudtrail-trails-are-integrated-with-cloudwatch-logs"}, {"id": "CKV2_AWS_60", "name": "Ensure RDS instance with copy tags to snapshots is enabled", "shortDescription": {"text": "Ensure RDS instance with copy tags to snapshots is enabled"}, "fullDescription": {"text": "Ensure RDS instance with copy tags to snapshots is enabled"}, "help": {"text": "Ensure RDS instance with copy tags to snapshots is enabled\nResource: module.disaster_recovery.aws_db_instance.main"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-60"}, {"id": "CKV2_AWS_62", "name": "Ensure S3 buckets should have event notifications enabled", "shortDescription": {"text": "Ensure S3 buckets should have event notifications enabled"}, "fullDescription": {"text": "Ensure S3 buckets should have event notifications enabled"}, "help": {"text": "Ensure S3 buckets should have event notifications enabled\nResource: module.cicd.aws_s3_bucket.codepipeline_artifacts"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62"}, {"id": "CKV2_AWS_6", "name": "Ensure that S3 bucket has a Public Access block", "shortDescription": {"text": "Ensure that S3 bucket has a Public Access block"}, "fullDescription": {"text": "Ensure that S3 bucket has a Public Access block"}, "help": {"text": "Ensure that S3 bucket has a Public Access block\nResource: module.cicd.aws_s3_bucket.codepipeline_artifacts"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached"}, {"id": "CKV2_AWS_61", "name": "Ensure that an S3 bucket has a lifecycle configuration", "shortDescription": {"text": "Ensure that an S3 bucket has a lifecycle configuration"}, "fullDescription": {"text": "Ensure that an S3 bucket has a lifecycle configuration"}, "help": {"text": "Ensure that an S3 bucket has a lifecycle configuration\nResource: module.cicd.aws_s3_bucket.codepipeline_artifacts"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61"}, {"id": "CKV2_AWS_64", "name": "Ensure KMS key Policy is defined", "shortDescription": {"text": "Ensure KMS key Policy is defined"}, "fullDescription": {"text": "Ensure KMS key Policy is defined"}, "help": {"text": "Ensure KMS key Policy is defined\nResource: module.cicd.aws_kms_key.codebuild"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-64"}, {"id": "CKV_AWS_18", "name": "Ensure the S3 bucket has access logging enabled", "shortDescription": {"text": "Ensure the S3 bucket has access logging enabled"}, "fullDescription": {"text": "Ensure the S3 bucket has access logging enabled"}, "help": {"text": "Ensure the S3 bucket has access logging enabled\nResource: module.cicd.aws_s3_bucket.codepipeline_artifacts"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging"}, {"id": "CKV2_AWS_57", "name": "Ensure Secrets Manager secrets should have automatic rotation enabled", "shortDescription": {"text": "Ensure Secrets Manager secrets should have automatic rotation enabled"}, "fullDescription": {"text": "Ensure Secrets Manager secrets should have automatic rotation enabled"}, "help": {"text": "Ensure Secrets Manager secrets should have automatic rotation enabled\nResource: module.secrets.aws_secretsmanager_secret.rancher_password"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-57"}, {"id": "CKV2_AWS_5", "name": "Ensure that Security Groups are attached to another resource", "shortDescription": {"text": "Ensure that Security Groups are attached to another resource"}, "fullDescription": {"text": "Ensure that Security Groups are attached to another resource"}, "help": {"text": "Ensure that Security Groups are attached to another resource\nResource: module.security.aws_security_group.web"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis"}, {"id": "CKV2_AWS_11", "name": "Ensure VPC flow logging is enabled in all VPCs", "shortDescription": {"text": "Ensure VPC flow logging is enabled in all VPCs"}, "fullDescription": {"text": "Ensure VPC flow logging is enabled in all VPCs"}, "help": {"text": "Ensure VPC flow logging is enabled in all VPCs\nResource: module.disaster_recovery.aws_vpc.dr"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-9-enable-vpc-flow-logging"}, {"id": "CKV2_AWS_12", "name": "Ensure the default security group of every VPC restricts all traffic", "shortDescription": {"text": "Ensure the default security group of every VPC restricts all traffic"}, "fullDescription": {"text": "Ensure the default security group of every VPC restricts all traffic"}, "help": {"text": "Ensure the default security group of every VPC restricts all traffic\nResource: module.disaster_recovery.aws_vpc.dr"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-4"}, {"id": "CKV2_AWS_1", "name": "Ensure that all NACL are attached to subnets", "shortDescription": {"text": "Ensure that all NACL are attached to subnets"}, "fullDescription": {"text": "Ensure that all NACL are attached to subnets"}, "help": {"text": "Ensure that all NACL are attached to subnets\nResource: module.networking.aws_network_acl.private"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-all-nacl-are-attached-to-subnets"}, {"id": "CKV2_AWS_31", "name": "Ensure WAF2 has a Logging Configuration", "shortDescription": {"text": "Ensure WAF2 has a Logging Configuration"}, "fullDescription": {"text": "Ensure WAF2 has a Logging Configuration"}, "help": {"text": "Ensure WAF2 has a Logging Configuration\nResource: module.security.aws_wafv2_web_acl.main"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-logging-33"}, {"id": "CKV2_AWS_23", "name": "Route53 A Record has Attached Resource", "shortDescription": {"text": "Route53 A Record has Attached Resource"}, "fullDescription": {"text": "Route53 A Record has Attached Resource"}, "help": {"text": "Route53 A Record has Attached Resource\nResource: module.disaster_recovery.aws_route53_record.app_failover"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-route53-a-record-has-an-attached-resource"}, {"id": "CKV_AWS_21", "name": "Ensure all data stored in the S3 bucket have versioning enabled", "shortDescription": {"text": "Ensure all data stored in the S3 bucket have versioning enabled"}, "fullDescription": {"text": "Ensure all data stored in the S3 bucket have versioning enabled"}, "help": {"text": "Ensure all data stored in the S3 bucket have versioning enabled\nResource: module.event_systems.aws_s3_bucket.firehose_bucket"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning"}], "organization": "bridgecrew"}}, "results": [{"ruleId": "CKV_AWS_26", "ruleIndex": 0, "level": "error", "attachments": [], "message": {"text": "Ensure all data stored in the SNS topic is encrypted"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/eventbridge.tf"}, "region": {"startLine": 2, "endLine": 4, "snippet": {"text": "resource \"aws_sns_topic\" \"dr_alerts\" {\n  name = \"${var.project_name}-dr-alerts\"\n}\n"}}}}]}, {"ruleId": "CKV_AWS_130", "ruleIndex": 1, "level": "error", "attachments": [], "message": {"text": "Ensure VPC subnets do not assign public IP by default"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 54, "endLine": 67, "snippet": {"text": "resource \"aws_subnet\" \"dr_public\" {\n  provider = aws.dr_region\n  count    = length(local.dr_azs)\n\n  vpc_id                  = aws_vpc.dr.id\n  cidr_block              = cidrsubnet(var.dr_vpc_cidr, 8, count.index)\n  availability_zone       = local.dr_azs[count.index]\n  map_public_ip_on_launch = true\n\n  tags = {\n    Name = \"${var.project_name}-dr-public-${local.dr_azs[count.index]}\"\n    Type = \"Public\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_23", "ruleIndex": 2, "level": "error", "attachments": [], "message": {"text": "Ensure every security group and rule has a description"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 167, "endLine": 189, "snippet": {"text": "resource \"aws_security_group\" \"dr_rds\" {\n  provider    = aws.dr_region\n  name_prefix = \"${var.project_name}-dr-rds-\"\n  vpc_id      = aws_vpc.dr.id\n\n  ingress {\n    from_port   = 3306\n    to_port     = 3306\n    protocol    = \"tcp\"\n    cidr_blocks = [var.dr_vpc_cidr]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = \"${var.project_name}-dr-rds-sg\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_382", "ruleIndex": 3, "level": "error", "attachments": [], "message": {"text": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 167, "endLine": 189, "snippet": {"text": "resource \"aws_security_group\" \"dr_rds\" {\n  provider    = aws.dr_region\n  name_prefix = \"${var.project_name}-dr-rds-\"\n  vpc_id      = aws_vpc.dr.id\n\n  ingress {\n    from_port   = 3306\n    to_port     = 3306\n    protocol    = \"tcp\"\n    cidr_blocks = [var.dr_vpc_cidr]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = \"${var.project_name}-dr-rds-sg\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_129", "ruleIndex": 4, "level": "error", "attachments": [], "message": {"text": "Ensure that respective logs of Amazon Relational Database Service (Amazon RDS) are enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 192, "endLine": 212, "snippet": {"text": "resource \"aws_db_instance\" \"dr_replica\" {\n  provider                   = aws.dr_region\n  identifier                 = \"${var.project_name}-dr-database\"\n  replicate_source_db        = aws_db_instance.main.arn\n  instance_class             = \"db.t3.micro\" # Smaller instance for cost efficiency\n  vpc_security_group_ids     = [aws_security_group.dr_rds.id]\n  db_subnet_group_name       = aws_db_subnet_group.dr.name\n  skip_final_snapshot        = true\n  auto_minor_version_upgrade = true\n\n  # For a pilot light setup, consider:\n  multi_az                = false # Can be true for higher DR reliability\n  backup_retention_period = 5     # Fewer days than primary \n\n  tags = {\n    Name        = \"${var.project_name}-dr-database\"\n    Environment = \"dr\"\n  }\n\n  depends_on = [aws_db_instance.main]\n}\n"}}}}]}, {"ruleId": "CKV_AWS_16", "ruleIndex": 5, "level": "error", "attachments": [], "message": {"text": "Ensure all data stored in the RDS is securely encrypted at rest"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 192, "endLine": 212, "snippet": {"text": "resource \"aws_db_instance\" \"dr_replica\" {\n  provider                   = aws.dr_region\n  identifier                 = \"${var.project_name}-dr-database\"\n  replicate_source_db        = aws_db_instance.main.arn\n  instance_class             = \"db.t3.micro\" # Smaller instance for cost efficiency\n  vpc_security_group_ids     = [aws_security_group.dr_rds.id]\n  db_subnet_group_name       = aws_db_subnet_group.dr.name\n  skip_final_snapshot        = true\n  auto_minor_version_upgrade = true\n\n  # For a pilot light setup, consider:\n  multi_az                = false # Can be true for higher DR reliability\n  backup_retention_period = 5     # Fewer days than primary \n\n  tags = {\n    Name        = \"${var.project_name}-dr-database\"\n    Environment = \"dr\"\n  }\n\n  depends_on = [aws_db_instance.main]\n}\n"}}}}]}, {"ruleId": "CKV_AWS_118", "ruleIndex": 6, "level": "error", "attachments": [], "message": {"text": "Ensure that enhanced monitoring is enabled for Amazon RDS instances"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 192, "endLine": 212, "snippet": {"text": "resource \"aws_db_instance\" \"dr_replica\" {\n  provider                   = aws.dr_region\n  identifier                 = \"${var.project_name}-dr-database\"\n  replicate_source_db        = aws_db_instance.main.arn\n  instance_class             = \"db.t3.micro\" # Smaller instance for cost efficiency\n  vpc_security_group_ids     = [aws_security_group.dr_rds.id]\n  db_subnet_group_name       = aws_db_subnet_group.dr.name\n  skip_final_snapshot        = true\n  auto_minor_version_upgrade = true\n\n  # For a pilot light setup, consider:\n  multi_az                = false # Can be true for higher DR reliability\n  backup_retention_period = 5     # Fewer days than primary \n\n  tags = {\n    Name        = \"${var.project_name}-dr-database\"\n    Environment = \"dr\"\n  }\n\n  depends_on = [aws_db_instance.main]\n}\n"}}}}]}, {"ruleId": "CKV_AWS_293", "ruleIndex": 7, "level": "error", "attachments": [], "message": {"text": "Ensure that AWS database instances have deletion protection enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 192, "endLine": 212, "snippet": {"text": "resource \"aws_db_instance\" \"dr_replica\" {\n  provider                   = aws.dr_region\n  identifier                 = \"${var.project_name}-dr-database\"\n  replicate_source_db        = aws_db_instance.main.arn\n  instance_class             = \"db.t3.micro\" # Smaller instance for cost efficiency\n  vpc_security_group_ids     = [aws_security_group.dr_rds.id]\n  db_subnet_group_name       = aws_db_subnet_group.dr.name\n  skip_final_snapshot        = true\n  auto_minor_version_upgrade = true\n\n  # For a pilot light setup, consider:\n  multi_az                = false # Can be true for higher DR reliability\n  backup_retention_period = 5     # Fewer days than primary \n\n  tags = {\n    Name        = \"${var.project_name}-dr-database\"\n    Environment = \"dr\"\n  }\n\n  depends_on = [aws_db_instance.main]\n}\n"}}}}]}, {"ruleId": "CKV_AWS_353", "ruleIndex": 8, "level": "error", "attachments": [], "message": {"text": "Ensure that RDS instances have performance insights enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 192, "endLine": 212, "snippet": {"text": "resource \"aws_db_instance\" \"dr_replica\" {\n  provider                   = aws.dr_region\n  identifier                 = \"${var.project_name}-dr-database\"\n  replicate_source_db        = aws_db_instance.main.arn\n  instance_class             = \"db.t3.micro\" # Smaller instance for cost efficiency\n  vpc_security_group_ids     = [aws_security_group.dr_rds.id]\n  db_subnet_group_name       = aws_db_subnet_group.dr.name\n  skip_final_snapshot        = true\n  auto_minor_version_upgrade = true\n\n  # For a pilot light setup, consider:\n  multi_az                = false # Can be true for higher DR reliability\n  backup_retention_period = 5     # Fewer days than primary \n\n  tags = {\n    Name        = \"${var.project_name}-dr-database\"\n    Environment = \"dr\"\n  }\n\n  depends_on = [aws_db_instance.main]\n}\n"}}}}]}, {"ruleId": "CKV_AWS_157", "ruleIndex": 9, "level": "error", "attachments": [], "message": {"text": "Ensure that RDS instances have Multi-AZ enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 192, "endLine": 212, "snippet": {"text": "resource \"aws_db_instance\" \"dr_replica\" {\n  provider                   = aws.dr_region\n  identifier                 = \"${var.project_name}-dr-database\"\n  replicate_source_db        = aws_db_instance.main.arn\n  instance_class             = \"db.t3.micro\" # Smaller instance for cost efficiency\n  vpc_security_group_ids     = [aws_security_group.dr_rds.id]\n  db_subnet_group_name       = aws_db_subnet_group.dr.name\n  skip_final_snapshot        = true\n  auto_minor_version_upgrade = true\n\n  # For a pilot light setup, consider:\n  multi_az                = false # Can be true for higher DR reliability\n  backup_retention_period = 5     # Fewer days than primary \n\n  tags = {\n    Name        = \"${var.project_name}-dr-database\"\n    Environment = \"dr\"\n  }\n\n  depends_on = [aws_db_instance.main]\n}\n"}}}}]}, {"ruleId": "CKV_AWS_338", "ruleIndex": 10, "level": "error", "attachments": [], "message": {"text": "Ensure CloudWatch log groups retains logs for at least 1 year"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 441, "endLine": 446, "snippet": {"text": "resource \"aws_cloudwatch_log_group\" \"dr_eks\" {\n  provider          = aws.dr_region\n  name              = \"/aws/eks/${var.project_name}-dr/cluster\"\n  retention_in_days = 30\n  kms_key_id        = aws_kms_key.dr_logs.arn\n}\n"}}}}]}, {"ruleId": "CKV_AWS_37", "ruleIndex": 11, "level": "error", "attachments": [], "message": {"text": "Ensure Amazon EKS control plane logging is enabled for all log types"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 477, "endLine": 509, "snippet": {"text": "resource \"aws_eks_cluster\" \"dr\" {\n  provider = aws.dr_region\n  name     = \"${var.project_name}-dr-eks\"\n  role_arn = aws_iam_role.eks_cluster_role.arn\n  version  = \"1.32\"\n\n  vpc_config {\n    subnet_ids              = aws_subnet.dr_private[*].id\n    endpoint_private_access = true\n    endpoint_public_access  = true\n    public_access_cidrs     = [\"0.0.0.0/0\"] # Consider restricting in production\n    security_group_ids      = [aws_security_group.dr_eks_cluster.id]\n  }\n\n  encryption_config {\n    provider {\n      key_arn = aws_kms_key.dr_logs.arn\n    }\n    resources = [\"secrets\"]\n  }\n\n  enabled_cluster_log_types = [\"api\", \"audit\"]\n\n  # Reduced logging compared to primary for cost efficiency\n\n  depends_on = [\n    aws_cloudwatch_log_group.dr_eks,\n  ]\n\n  tags = {\n    Name = \"${var.project_name}-dr-eks-cluster\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_39", "ruleIndex": 12, "level": "error", "attachments": [], "message": {"text": "Ensure Amazon EKS public endpoint disabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 477, "endLine": 509, "snippet": {"text": "resource \"aws_eks_cluster\" \"dr\" {\n  provider = aws.dr_region\n  name     = \"${var.project_name}-dr-eks\"\n  role_arn = aws_iam_role.eks_cluster_role.arn\n  version  = \"1.32\"\n\n  vpc_config {\n    subnet_ids              = aws_subnet.dr_private[*].id\n    endpoint_private_access = true\n    endpoint_public_access  = true\n    public_access_cidrs     = [\"0.0.0.0/0\"] # Consider restricting in production\n    security_group_ids      = [aws_security_group.dr_eks_cluster.id]\n  }\n\n  encryption_config {\n    provider {\n      key_arn = aws_kms_key.dr_logs.arn\n    }\n    resources = [\"secrets\"]\n  }\n\n  enabled_cluster_log_types = [\"api\", \"audit\"]\n\n  # Reduced logging compared to primary for cost efficiency\n\n  depends_on = [\n    aws_cloudwatch_log_group.dr_eks,\n  ]\n\n  tags = {\n    Name = \"${var.project_name}-dr-eks-cluster\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_38", "ruleIndex": 13, "level": "error", "attachments": [], "message": {"text": "Ensure Amazon EKS public endpoint not accessible to 0.0.0.0/0"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 477, "endLine": 509, "snippet": {"text": "resource \"aws_eks_cluster\" \"dr\" {\n  provider = aws.dr_region\n  name     = \"${var.project_name}-dr-eks\"\n  role_arn = aws_iam_role.eks_cluster_role.arn\n  version  = \"1.32\"\n\n  vpc_config {\n    subnet_ids              = aws_subnet.dr_private[*].id\n    endpoint_private_access = true\n    endpoint_public_access  = true\n    public_access_cidrs     = [\"0.0.0.0/0\"] # Consider restricting in production\n    security_group_ids      = [aws_security_group.dr_eks_cluster.id]\n  }\n\n  encryption_config {\n    provider {\n      key_arn = aws_kms_key.dr_logs.arn\n    }\n    resources = [\"secrets\"]\n  }\n\n  enabled_cluster_log_types = [\"api\", \"audit\"]\n\n  # Reduced logging compared to primary for cost efficiency\n\n  depends_on = [\n    aws_cloudwatch_log_group.dr_eks,\n  ]\n\n  tags = {\n    Name = \"${var.project_name}-dr-eks-cluster\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_28", "ruleIndex": 14, "level": "error", "attachments": [], "message": {"text": "Ensure DynamoDB point in time recovery (backup) is enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 549, "endLine": 569, "snippet": {"text": "resource \"aws_dynamodb_table\" \"primary\" {\n  name             = \"${var.project_name}-session-store\"\n  billing_mode     = \"PAY_PER_REQUEST\"\n  hash_key         = \"SessionId\"\n  stream_enabled   = true\n  stream_view_type = \"NEW_AND_OLD_IMAGES\" # Required for global tables\n\n  attribute {\n    name = \"SessionId\"\n    type = \"S\"\n  }\n\n  ttl {\n    attribute_name = \"TimeToExist\"\n    enabled        = true\n  }\n\n  tags = {\n    Name = \"${var.project_name}-session-store\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_119", "ruleIndex": 15, "level": "error", "attachments": [], "message": {"text": "Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 549, "endLine": 569, "snippet": {"text": "resource \"aws_dynamodb_table\" \"primary\" {\n  name             = \"${var.project_name}-session-store\"\n  billing_mode     = \"PAY_PER_REQUEST\"\n  hash_key         = \"SessionId\"\n  stream_enabled   = true\n  stream_view_type = \"NEW_AND_OLD_IMAGES\" # Required for global tables\n\n  attribute {\n    name = \"SessionId\"\n    type = \"S\"\n  }\n\n  ttl {\n    attribute_name = \"TimeToExist\"\n    enabled        = true\n  }\n\n  tags = {\n    Name = \"${var.project_name}-session-store\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_28", "ruleIndex": 14, "level": "error", "attachments": [], "message": {"text": "Ensure DynamoDB point in time recovery (backup) is enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 571, "endLine": 592, "snippet": {"text": "resource \"aws_dynamodb_table\" \"dr\" {\n  provider         = aws.dr_region\n  name             = \"${var.project_name}-session-store\"\n  billing_mode     = \"PAY_PER_REQUEST\"\n  hash_key         = \"SessionId\"\n  stream_enabled   = true\n  stream_view_type = \"NEW_AND_OLD_IMAGES\"\n\n  attribute {\n    name = \"SessionId\"\n    type = \"S\"\n  }\n\n  ttl {\n    attribute_name = \"TimeToExist\"\n    enabled        = true\n  }\n\n  tags = {\n    Name = \"${var.project_name}-dr-session-store\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_119", "ruleIndex": 15, "level": "error", "attachments": [], "message": {"text": "Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 571, "endLine": 592, "snippet": {"text": "resource \"aws_dynamodb_table\" \"dr\" {\n  provider         = aws.dr_region\n  name             = \"${var.project_name}-session-store\"\n  billing_mode     = \"PAY_PER_REQUEST\"\n  hash_key         = \"SessionId\"\n  stream_enabled   = true\n  stream_view_type = \"NEW_AND_OLD_IMAGES\"\n\n  attribute {\n    name = \"SessionId\"\n    type = \"S\"\n  }\n\n  ttl {\n    attribute_name = \"TimeToExist\"\n    enabled        = true\n  }\n\n  tags = {\n    Name = \"${var.project_name}-dr-session-store\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_355", "ruleIndex": 16, "level": "error", "attachments": [], "message": {"text": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 650, "endLine": 669, "snippet": {"text": "resource \"aws_iam_policy\" \"dr_failover_lambda\" {\n  name = \"${var.project_name}-dr-failover-lambda-policy\"\n\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Effect = \"Allow\"\n        Action = [\n          \"route53:ChangeResourceRecordSets\",\n          \"cloudwatch:PutMetricData\",\n          \"logs:CreateLogGroup\",\n          \"logs:CreateLogStream\",\n          \"logs:PutLogEvents\"\n        ]\n        Resource = \"*\"\n      }\n    ]\n  })\n}\n"}}}}]}, {"ruleId": "CKV_AWS_290", "ruleIndex": 17, "level": "error", "attachments": [], "message": {"text": "Ensure IAM policies does not allow write access without constraints"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 650, "endLine": 669, "snippet": {"text": "resource \"aws_iam_policy\" \"dr_failover_lambda\" {\n  name = \"${var.project_name}-dr-failover-lambda-policy\"\n\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Effect = \"Allow\"\n        Action = [\n          \"route53:ChangeResourceRecordSets\",\n          \"cloudwatch:PutMetricData\",\n          \"logs:CreateLogGroup\",\n          \"logs:CreateLogStream\",\n          \"logs:PutLogEvents\"\n        ]\n        Resource = \"*\"\n      }\n    ]\n  })\n}\n"}}}}]}, {"ruleId": "CKV_AWS_272", "ruleIndex": 18, "level": "error", "attachments": [], "message": {"text": "Ensure AWS Lambda function is configured to validate code-signing"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 676, "endLine": 694, "snippet": {"text": "resource \"aws_lambda_function\" \"dr_failover\" {\n  function_name = \"${var.project_name}-dr-failover\"\n  role          = aws_iam_role.dr_failover_lambda.arn\n  handler       = \"index.handler\"\n  runtime       = \"nodejs18.x\"\n  timeout       = 60\n\n  filename         = \"${path.module}/dr_failover_function.zip\"\n  source_code_hash = filebase64sha256(\"${path.module}/dr_failover_function.zip\")\n\n  environment {\n    variables = {\n      PRIMARY_REGION     = var.aws_region\n      DR_REGION          = var.dr_region\n      HOSTED_ZONE_ID     = data.aws_route53_zone.main.zone_id\n      APPLICATION_DOMAIN = var.application_domain\n    }\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_116", "ruleIndex": 19, "level": "error", "attachments": [], "message": {"text": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 676, "endLine": 694, "snippet": {"text": "resource \"aws_lambda_function\" \"dr_failover\" {\n  function_name = \"${var.project_name}-dr-failover\"\n  role          = aws_iam_role.dr_failover_lambda.arn\n  handler       = \"index.handler\"\n  runtime       = \"nodejs18.x\"\n  timeout       = 60\n\n  filename         = \"${path.module}/dr_failover_function.zip\"\n  source_code_hash = filebase64sha256(\"${path.module}/dr_failover_function.zip\")\n\n  environment {\n    variables = {\n      PRIMARY_REGION     = var.aws_region\n      DR_REGION          = var.dr_region\n      HOSTED_ZONE_ID     = data.aws_route53_zone.main.zone_id\n      APPLICATION_DOMAIN = var.application_domain\n    }\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_173", "ruleIndex": 20, "level": "error", "attachments": [], "message": {"text": "Check encryption settings for Lambda environmental variable"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 676, "endLine": 694, "snippet": {"text": "resource \"aws_lambda_function\" \"dr_failover\" {\n  function_name = \"${var.project_name}-dr-failover\"\n  role          = aws_iam_role.dr_failover_lambda.arn\n  handler       = \"index.handler\"\n  runtime       = \"nodejs18.x\"\n  timeout       = 60\n\n  filename         = \"${path.module}/dr_failover_function.zip\"\n  source_code_hash = filebase64sha256(\"${path.module}/dr_failover_function.zip\")\n\n  environment {\n    variables = {\n      PRIMARY_REGION     = var.aws_region\n      DR_REGION          = var.dr_region\n      HOSTED_ZONE_ID     = data.aws_route53_zone.main.zone_id\n      APPLICATION_DOMAIN = var.application_domain\n    }\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_115", "ruleIndex": 21, "level": "error", "attachments": [], "message": {"text": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 676, "endLine": 694, "snippet": {"text": "resource \"aws_lambda_function\" \"dr_failover\" {\n  function_name = \"${var.project_name}-dr-failover\"\n  role          = aws_iam_role.dr_failover_lambda.arn\n  handler       = \"index.handler\"\n  runtime       = \"nodejs18.x\"\n  timeout       = 60\n\n  filename         = \"${path.module}/dr_failover_function.zip\"\n  source_code_hash = filebase64sha256(\"${path.module}/dr_failover_function.zip\")\n\n  environment {\n    variables = {\n      PRIMARY_REGION     = var.aws_region\n      DR_REGION          = var.dr_region\n      HOSTED_ZONE_ID     = data.aws_route53_zone.main.zone_id\n      APPLICATION_DOMAIN = var.application_domain\n    }\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_117", "ruleIndex": 22, "level": "error", "attachments": [], "message": {"text": "Ensure that AWS Lambda function is configured inside a VPC"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 676, "endLine": 694, "snippet": {"text": "resource \"aws_lambda_function\" \"dr_failover\" {\n  function_name = \"${var.project_name}-dr-failover\"\n  role          = aws_iam_role.dr_failover_lambda.arn\n  handler       = \"index.handler\"\n  runtime       = \"nodejs18.x\"\n  timeout       = 60\n\n  filename         = \"${path.module}/dr_failover_function.zip\"\n  source_code_hash = filebase64sha256(\"${path.module}/dr_failover_function.zip\")\n\n  environment {\n    variables = {\n      PRIMARY_REGION     = var.aws_region\n      DR_REGION          = var.dr_region\n      HOSTED_ZONE_ID     = data.aws_route53_zone.main.zone_id\n      APPLICATION_DOMAIN = var.application_domain\n    }\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_50", "ruleIndex": 23, "level": "error", "attachments": [], "message": {"text": "X-Ray tracing is enabled for Lambda"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 676, "endLine": 694, "snippet": {"text": "resource \"aws_lambda_function\" \"dr_failover\" {\n  function_name = \"${var.project_name}-dr-failover\"\n  role          = aws_iam_role.dr_failover_lambda.arn\n  handler       = \"index.handler\"\n  runtime       = \"nodejs18.x\"\n  timeout       = 60\n\n  filename         = \"${path.module}/dr_failover_function.zip\"\n  source_code_hash = filebase64sha256(\"${path.module}/dr_failover_function.zip\")\n\n  environment {\n    variables = {\n      PRIMARY_REGION     = var.aws_region\n      DR_REGION          = var.dr_region\n      HOSTED_ZONE_ID     = data.aws_route53_zone.main.zone_id\n      APPLICATION_DOMAIN = var.application_domain\n    }\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_272", "ruleIndex": 18, "level": "error", "attachments": [], "message": {"text": "Ensure AWS Lambda function is configured to validate code-signing"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/sync-sizes.tf"}, "region": {"startLine": 1, "endLine": 18, "snippet": {"text": "resource \"aws_lambda_function\" \"sync_sizes\" {\n  filename      = \"${path.module}/sync-sizes.zip\"\n  function_name = \"${var.project_name}-sync-cluster-sizes\"\n  role          = aws_iam_role.lambda_exec.arn\n  handler       = \"index.handler\"\n  runtime       = \"nodejs18.x\"\n  timeout       = 300\n\n  environment {\n    variables = {\n      PRIMARY_REGION     = var.aws_region\n      DR_REGION          = var.dr_region\n      CLUSTER_NAME       = var.project_name\n      NODE_GROUP_NAME    = \"${var.project_name}-nodes\"\n      DR_NODE_GROUP_NAME = \"${var.project_name}-dr-nodes\"\n    }\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_116", "ruleIndex": 19, "level": "error", "attachments": [], "message": {"text": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/sync-sizes.tf"}, "region": {"startLine": 1, "endLine": 18, "snippet": {"text": "resource \"aws_lambda_function\" \"sync_sizes\" {\n  filename      = \"${path.module}/sync-sizes.zip\"\n  function_name = \"${var.project_name}-sync-cluster-sizes\"\n  role          = aws_iam_role.lambda_exec.arn\n  handler       = \"index.handler\"\n  runtime       = \"nodejs18.x\"\n  timeout       = 300\n\n  environment {\n    variables = {\n      PRIMARY_REGION     = var.aws_region\n      DR_REGION          = var.dr_region\n      CLUSTER_NAME       = var.project_name\n      NODE_GROUP_NAME    = \"${var.project_name}-nodes\"\n      DR_NODE_GROUP_NAME = \"${var.project_name}-dr-nodes\"\n    }\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_173", "ruleIndex": 20, "level": "error", "attachments": [], "message": {"text": "Check encryption settings for Lambda environmental variable"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/sync-sizes.tf"}, "region": {"startLine": 1, "endLine": 18, "snippet": {"text": "resource \"aws_lambda_function\" \"sync_sizes\" {\n  filename      = \"${path.module}/sync-sizes.zip\"\n  function_name = \"${var.project_name}-sync-cluster-sizes\"\n  role          = aws_iam_role.lambda_exec.arn\n  handler       = \"index.handler\"\n  runtime       = \"nodejs18.x\"\n  timeout       = 300\n\n  environment {\n    variables = {\n      PRIMARY_REGION     = var.aws_region\n      DR_REGION          = var.dr_region\n      CLUSTER_NAME       = var.project_name\n      NODE_GROUP_NAME    = \"${var.project_name}-nodes\"\n      DR_NODE_GROUP_NAME = \"${var.project_name}-dr-nodes\"\n    }\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_115", "ruleIndex": 21, "level": "error", "attachments": [], "message": {"text": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/sync-sizes.tf"}, "region": {"startLine": 1, "endLine": 18, "snippet": {"text": "resource \"aws_lambda_function\" \"sync_sizes\" {\n  filename      = \"${path.module}/sync-sizes.zip\"\n  function_name = \"${var.project_name}-sync-cluster-sizes\"\n  role          = aws_iam_role.lambda_exec.arn\n  handler       = \"index.handler\"\n  runtime       = \"nodejs18.x\"\n  timeout       = 300\n\n  environment {\n    variables = {\n      PRIMARY_REGION     = var.aws_region\n      DR_REGION          = var.dr_region\n      CLUSTER_NAME       = var.project_name\n      NODE_GROUP_NAME    = \"${var.project_name}-nodes\"\n      DR_NODE_GROUP_NAME = \"${var.project_name}-dr-nodes\"\n    }\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_117", "ruleIndex": 22, "level": "error", "attachments": [], "message": {"text": "Ensure that AWS Lambda function is configured inside a VPC"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/sync-sizes.tf"}, "region": {"startLine": 1, "endLine": 18, "snippet": {"text": "resource \"aws_lambda_function\" \"sync_sizes\" {\n  filename      = \"${path.module}/sync-sizes.zip\"\n  function_name = \"${var.project_name}-sync-cluster-sizes\"\n  role          = aws_iam_role.lambda_exec.arn\n  handler       = \"index.handler\"\n  runtime       = \"nodejs18.x\"\n  timeout       = 300\n\n  environment {\n    variables = {\n      PRIMARY_REGION     = var.aws_region\n      DR_REGION          = var.dr_region\n      CLUSTER_NAME       = var.project_name\n      NODE_GROUP_NAME    = \"${var.project_name}-nodes\"\n      DR_NODE_GROUP_NAME = \"${var.project_name}-dr-nodes\"\n    }\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_50", "ruleIndex": 23, "level": "error", "attachments": [], "message": {"text": "X-Ray tracing is enabled for Lambda"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/sync-sizes.tf"}, "region": {"startLine": 1, "endLine": 18, "snippet": {"text": "resource \"aws_lambda_function\" \"sync_sizes\" {\n  filename      = \"${path.module}/sync-sizes.zip\"\n  function_name = \"${var.project_name}-sync-cluster-sizes\"\n  role          = aws_iam_role.lambda_exec.arn\n  handler       = \"index.handler\"\n  runtime       = \"nodejs18.x\"\n  timeout       = 300\n\n  environment {\n    variables = {\n      PRIMARY_REGION     = var.aws_region\n      DR_REGION          = var.dr_region\n      CLUSTER_NAME       = var.project_name\n      NODE_GROUP_NAME    = \"${var.project_name}-nodes\"\n      DR_NODE_GROUP_NAME = \"${var.project_name}-dr-nodes\"\n    }\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_355", "ruleIndex": 16, "level": "error", "attachments": [], "message": {"text": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/sync-sizes.tf"}, "region": {"startLine": 141, "endLine": 159, "snippet": {"text": "resource \"aws_iam_policy\" \"lambda_eks_access\" {\n  name        = \"${var.project_name}-lambda-eks-access\"\n  description = \"Policy for Lambda to access EKS\"\n\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Effect = \"Allow\"\n        Action = [\n          \"eks:ListNodegroups\",\n          \"eks:DescribeNodegroup\",\n          \"eks:UpdateNodegroupConfig\"\n        ]\n        Resource = \"*\"\n      }\n    ]\n  })\n}\n"}}}}]}, {"ruleId": "CKV_AWS_290", "ruleIndex": 17, "level": "error", "attachments": [], "message": {"text": "Ensure IAM policies does not allow write access without constraints"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/sync-sizes.tf"}, "region": {"startLine": 141, "endLine": 159, "snippet": {"text": "resource \"aws_iam_policy\" \"lambda_eks_access\" {\n  name        = \"${var.project_name}-lambda-eks-access\"\n  description = \"Policy for Lambda to access EKS\"\n\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Effect = \"Allow\"\n        Action = [\n          \"eks:ListNodegroups\",\n          \"eks:DescribeNodegroup\",\n          \"eks:UpdateNodegroupConfig\"\n        ]\n        Resource = \"*\"\n      }\n    ]\n  })\n}\n"}}}}]}, {"ruleId": "CKV_AWS_158", "ruleIndex": 24, "level": "error", "attachments": [], "message": {"text": "Ensure that CloudWatch Log Group is encrypted by KMS"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/sync-sizes.tf"}, "region": {"startLine": 167, "endLine": 170, "snippet": {"text": "resource \"aws_cloudwatch_log_group\" \"sync_sizes\" {\n  name              = \"/aws/lambda/${aws_lambda_function.sync_sizes.function_name}\"\n  retention_in_days = 30\n}\n"}}}}]}, {"ruleId": "CKV_AWS_338", "ruleIndex": 10, "level": "error", "attachments": [], "message": {"text": "Ensure CloudWatch log groups retains logs for at least 1 year"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/sync-sizes.tf"}, "region": {"startLine": 167, "endLine": 170, "snippet": {"text": "resource \"aws_cloudwatch_log_group\" \"sync_sizes\" {\n  name              = \"/aws/lambda/${aws_lambda_function.sync_sizes.function_name}\"\n  retention_in_days = 30\n}\n"}}}}]}, {"ruleId": "CKV_AWS_26", "ruleIndex": 0, "level": "error", "attachments": [], "message": {"text": "Ensure all data stored in the SNS topic is encrypted"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/event-systems/main.tf"}, "region": {"startLine": 160, "endLine": 162, "snippet": {"text": "resource \"aws_sns_topic\" \"main\" {\n  name = \"${var.project_name}-topic\"\n}\n"}}}}]}, {"ruleId": "CKV_AWS_26", "ruleIndex": 0, "level": "error", "attachments": [], "message": {"text": "Ensure all data stored in the SNS topic is encrypted"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/monitoring/main.tf"}, "region": {"startLine": 87, "endLine": 89, "snippet": {"text": "resource \"aws_sns_topic\" \"alerts\" {\n  name = \"${var.project_name}-alerts\"\n}\n"}}}}]}, {"ruleId": "CKV_AWS_252", "ruleIndex": 25, "level": "error", "attachments": [], "message": {"text": "Ensure CloudTrail defines an SNS Topic"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/monitoring/main.tf"}, "region": {"startLine": 92, "endLine": 106, "snippet": {"text": "resource \"aws_cloudtrail\" \"main\" {\n  name           = \"${var.project_name}-trail\"\n  s3_bucket_name = aws_s3_bucket.cloudtrail.bucket\n\n  event_selector {\n    read_write_type                  = \"All\"\n    include_management_events        = true\n    exclude_management_event_sources = []\n\n    data_resource {\n      type   = \"AWS::S3::Object\"\n      values = [\"arn:aws:s3:::*/*\"]\n    }\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_35", "ruleIndex": 26, "level": "error", "attachments": [], "message": {"text": "Ensure CloudTrail logs are encrypted at rest using KMS CMKs"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/monitoring/main.tf"}, "region": {"startLine": 92, "endLine": 106, "snippet": {"text": "resource \"aws_cloudtrail\" \"main\" {\n  name           = \"${var.project_name}-trail\"\n  s3_bucket_name = aws_s3_bucket.cloudtrail.bucket\n\n  event_selector {\n    read_write_type                  = \"All\"\n    include_management_events        = true\n    exclude_management_event_sources = []\n\n    data_resource {\n      type   = \"AWS::S3::Object\"\n      values = [\"arn:aws:s3:::*/*\"]\n    }\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_36", "ruleIndex": 27, "level": "error", "attachments": [], "message": {"text": "Ensure CloudTrail log file validation is enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/monitoring/main.tf"}, "region": {"startLine": 92, "endLine": 106, "snippet": {"text": "resource \"aws_cloudtrail\" \"main\" {\n  name           = \"${var.project_name}-trail\"\n  s3_bucket_name = aws_s3_bucket.cloudtrail.bucket\n\n  event_selector {\n    read_write_type                  = \"All\"\n    include_management_events        = true\n    exclude_management_event_sources = []\n\n    data_resource {\n      type   = \"AWS::S3::Object\"\n      values = [\"arn:aws:s3:::*/*\"]\n    }\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_67", "ruleIndex": 28, "level": "error", "attachments": [], "message": {"text": "Ensure CloudTrail is enabled in all Regions"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/monitoring/main.tf"}, "region": {"startLine": 92, "endLine": 106, "snippet": {"text": "resource \"aws_cloudtrail\" \"main\" {\n  name           = \"${var.project_name}-trail\"\n  s3_bucket_name = aws_s3_bucket.cloudtrail.bucket\n\n  event_selector {\n    read_write_type                  = \"All\"\n    include_management_events        = true\n    exclude_management_event_sources = []\n\n    data_resource {\n      type   = \"AWS::S3::Object\"\n      values = [\"arn:aws:s3:::*/*\"]\n    }\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_158", "ruleIndex": 24, "level": "error", "attachments": [], "message": {"text": "Ensure that CloudWatch Log Group is encrypted by KMS"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/monitoring/main.tf"}, "region": {"startLine": 161, "endLine": 164, "snippet": {"text": "resource \"aws_cloudwatch_log_group\" \"vpc_flow_log\" {\n  name              = \"/aws/vpc/flowlogs\"\n  retention_in_days = 7\n}\n"}}}}]}, {"ruleId": "CKV_AWS_338", "ruleIndex": 10, "level": "error", "attachments": [], "message": {"text": "Ensure CloudWatch log groups retains logs for at least 1 year"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/monitoring/main.tf"}, "region": {"startLine": 161, "endLine": 164, "snippet": {"text": "resource \"aws_cloudwatch_log_group\" \"vpc_flow_log\" {\n  name              = \"/aws/vpc/flowlogs\"\n  retention_in_days = 7\n}\n"}}}}]}, {"ruleId": "CKV_AWS_355", "ruleIndex": 16, "level": "error", "attachments": [], "message": {"text": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/monitoring/main.tf"}, "region": {"startLine": 183, "endLine": 203, "snippet": {"text": "resource \"aws_iam_role_policy\" \"flow_log\" {\n  name = \"${var.project_name}-flow-log-policy\"\n  role = aws_iam_role.flow_log.id\n\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Action = [\n          \"logs:CreateLogGroup\",\n          \"logs:CreateLogStream\",\n          \"logs:PutLogEvents\",\n          \"logs:DescribeLogGroups\",\n          \"logs:DescribeLogStreams\"\n        ]\n        Effect   = \"Allow\"\n        Resource = \"*\"\n      }\n    ]\n  })\n}\n"}}}}]}, {"ruleId": "CKV_AWS_290", "ruleIndex": 17, "level": "error", "attachments": [], "message": {"text": "Ensure IAM policies does not allow write access without constraints"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/monitoring/main.tf"}, "region": {"startLine": 183, "endLine": 203, "snippet": {"text": "resource \"aws_iam_role_policy\" \"flow_log\" {\n  name = \"${var.project_name}-flow-log-policy\"\n  role = aws_iam_role.flow_log.id\n\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Action = [\n          \"logs:CreateLogGroup\",\n          \"logs:CreateLogStream\",\n          \"logs:PutLogEvents\",\n          \"logs:DescribeLogGroups\",\n          \"logs:DescribeLogStreams\"\n        ]\n        Effect   = \"Allow\"\n        Resource = \"*\"\n      }\n    ]\n  })\n}\n"}}}}]}, {"ruleId": "CKV_AWS_130", "ruleIndex": 1, "level": "error", "attachments": [], "message": {"text": "Ensure VPC subnets do not assign public IP by default"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/networking/main.tf"}, "region": {"startLine": 22, "endLine": 34, "snippet": {"text": "resource \"aws_subnet\" \"public\" {\n  count = length(var.azs)\n\n  vpc_id                  = aws_vpc.main.id\n  cidr_block              = cidrsubnet(var.vpc_cidr, 8, count.index)\n  availability_zone       = var.azs[count.index]\n  map_public_ip_on_launch = true\n\n  tags = {\n    Name = \"${var.project_name}-public-${var.azs[count.index]}\"\n    Type = \"Public\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_23", "ruleIndex": 2, "level": "error", "attachments": [], "message": {"text": "Ensure every security group and rule has a description"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/networking/main.tf"}, "region": {"startLine": 164, "endLine": 178, "snippet": {"text": "resource \"aws_security_group\" \"vpc_endpoints\" {\n  name_prefix = \"${var.project_name}-vpc-endpoints-\"\n  vpc_id      = aws_vpc.main.id\n\n  ingress {\n    from_port   = 443\n    to_port     = 443\n    protocol    = \"tcp\"\n    cidr_blocks = [var.vpc_cidr]\n  }\n\n  tags = {\n    Name = \"${var.project_name}-vpc-endpoints-sg\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_158", "ruleIndex": 24, "level": "error", "attachments": [], "message": {"text": "Ensure that CloudWatch Log Group is encrypted by KMS"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/observability/main.tf"}, "region": {"startLine": 2, "endLine": 9, "snippet": {"text": "resource \"aws_cloudwatch_log_group\" \"eks_observability\" {\n  name              = \"/aws/eks/${var.project_name}/observability\"\n  retention_in_days = 7\n\n  tags = {\n    Name = \"${var.project_name}-eks-observability\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_338", "ruleIndex": 10, "level": "error", "attachments": [], "message": {"text": "Ensure CloudWatch log groups retains logs for at least 1 year"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/observability/main.tf"}, "region": {"startLine": 2, "endLine": 9, "snippet": {"text": "resource \"aws_cloudwatch_log_group\" \"eks_observability\" {\n  name              = \"/aws/eks/${var.project_name}/observability\"\n  retention_in_days = 7\n\n  tags = {\n    Name = \"${var.project_name}-eks-observability\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_184", "ruleIndex": 29, "level": "error", "attachments": [], "message": {"text": "Ensure resource is encrypted by KMS using a customer managed Key (CMK)"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/observability/main.tf"}, "region": {"startLine": 12, "endLine": 19, "snippet": {"text": "resource \"aws_efs_file_system\" \"observability\" {\n  creation_token = \"${var.project_name}-observability-efs\"\n  encrypted      = true\n\n  tags = {\n    Name = \"${var.project_name}-observability-efs\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_23", "ruleIndex": 2, "level": "error", "attachments": [], "message": {"text": "Ensure every security group and rule has a description"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/observability/main.tf"}, "region": {"startLine": 30, "endLine": 51, "snippet": {"text": "resource \"aws_security_group\" \"efs\" {\n  name_prefix = \"${var.project_name}-efs-\"\n  vpc_id      = var.vpc_id\n\n  ingress {\n    from_port   = 2049\n    to_port     = 2049\n    protocol    = \"tcp\"\n    cidr_blocks = [\"10.0.0.0/8\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = \"${var.project_name}-efs-sg\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_382", "ruleIndex": 3, "level": "error", "attachments": [], "message": {"text": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/observability/main.tf"}, "region": {"startLine": 30, "endLine": 51, "snippet": {"text": "resource \"aws_security_group\" \"efs\" {\n  name_prefix = \"${var.project_name}-efs-\"\n  vpc_id      = var.vpc_id\n\n  ingress {\n    from_port   = 2049\n    to_port     = 2049\n    protocol    = \"tcp\"\n    cidr_blocks = [\"10.0.0.0/8\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = \"${var.project_name}-efs-sg\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_149", "ruleIndex": 30, "level": "error", "attachments": [], "message": {"text": "Ensure that Secrets Manager secret is encrypted using KMS CMK"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/secrets/main.tf"}, "region": {"startLine": 2, "endLine": 9, "snippet": {"text": "resource \"aws_secretsmanager_secret\" \"rancher_password\" {\n  name        = \"${var.project_name}-rancher-password\"\n  description = \"Bootstrap password for Rancher management\"\n\n  tags = {\n    Name = \"${var.project_name}-rancher-password\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_149", "ruleIndex": 30, "level": "error", "attachments": [], "message": {"text": "Ensure that Secrets Manager secret is encrypted using KMS CMK"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/secrets/main.tf"}, "region": {"startLine": 16, "endLine": 23, "snippet": {"text": "resource \"aws_secretsmanager_secret\" \"grafana_password\" {\n  name        = \"${var.project_name}-grafana-password\"\n  description = \"Admin password for Grafana\"\n\n  tags = {\n    Name = \"${var.project_name}-grafana-password\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_149", "ruleIndex": 30, "level": "error", "attachments": [], "message": {"text": "Ensure that Secrets Manager secret is encrypted using KMS CMK"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/secrets/main.tf"}, "region": {"startLine": 30, "endLine": 37, "snippet": {"text": "resource \"aws_secretsmanager_secret\" \"rds_password\" {\n  name        = \"${var.project_name}-rds-password\"\n  description = \"Master password for RDS database\"\n\n  tags = {\n    Name = \"${var.project_name}-rds-password\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_23", "ruleIndex": 2, "level": "error", "attachments": [], "message": {"text": "Ensure every security group and rule has a description"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/security/main.tf"}, "region": {"startLine": 2, "endLine": 30, "snippet": {"text": "resource \"aws_security_group\" \"web\" {\n  name_prefix = \"${var.project_name}-web-\"\n  vpc_id      = var.vpc_id\n\n  ingress {\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    from_port   = 443\n    to_port     = 443\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = \"${var.project_name}-web-sg\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_382", "ruleIndex": 3, "level": "error", "attachments": [], "message": {"text": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/security/main.tf"}, "region": {"startLine": 2, "endLine": 30, "snippet": {"text": "resource \"aws_security_group\" \"web\" {\n  name_prefix = \"${var.project_name}-web-\"\n  vpc_id      = var.vpc_id\n\n  ingress {\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    from_port   = 443\n    to_port     = 443\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = \"${var.project_name}-web-sg\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_260", "ruleIndex": 31, "level": "error", "attachments": [], "message": {"text": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/security/main.tf"}, "region": {"startLine": 2, "endLine": 30, "snippet": {"text": "resource \"aws_security_group\" \"web\" {\n  name_prefix = \"${var.project_name}-web-\"\n  vpc_id      = var.vpc_id\n\n  ingress {\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    from_port   = 443\n    to_port     = 443\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = \"${var.project_name}-web-sg\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_23", "ruleIndex": 2, "level": "error", "attachments": [], "message": {"text": "Ensure every security group and rule has a description"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/security/main.tf"}, "region": {"startLine": 32, "endLine": 60, "snippet": {"text": "resource \"aws_security_group\" \"eks\" {\n  name_prefix = \"${var.project_name}-eks-\"\n  vpc_id      = var.vpc_id\n\n  ingress {\n    from_port = 443\n    to_port   = 443\n    protocol  = \"tcp\"\n    self      = true\n  }\n\n  ingress {\n    from_port   = 1025\n    to_port     = 65535\n    protocol    = \"tcp\"\n    cidr_blocks = [\"10.0.0.0/8\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = \"${var.project_name}-eks-sg\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_382", "ruleIndex": 3, "level": "error", "attachments": [], "message": {"text": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/security/main.tf"}, "region": {"startLine": 32, "endLine": 60, "snippet": {"text": "resource \"aws_security_group\" \"eks\" {\n  name_prefix = \"${var.project_name}-eks-\"\n  vpc_id      = var.vpc_id\n\n  ingress {\n    from_port = 443\n    to_port   = 443\n    protocol  = \"tcp\"\n    self      = true\n  }\n\n  ingress {\n    from_port   = 1025\n    to_port     = 65535\n    protocol    = \"tcp\"\n    cidr_blocks = [\"10.0.0.0/8\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = \"${var.project_name}-eks-sg\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_23", "ruleIndex": 2, "level": "error", "attachments": [], "message": {"text": "Ensure every security group and rule has a description"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/security/main.tf"}, "region": {"startLine": 62, "endLine": 90, "snippet": {"text": "resource \"aws_security_group\" \"alb\" {\n  name_prefix = \"${var.project_name}-alb-\"\n  vpc_id      = var.vpc_id\n\n  ingress {\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    from_port   = 443\n    to_port     = 443\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = \"${var.project_name}-alb-sg\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_382", "ruleIndex": 3, "level": "error", "attachments": [], "message": {"text": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/security/main.tf"}, "region": {"startLine": 62, "endLine": 90, "snippet": {"text": "resource \"aws_security_group\" \"alb\" {\n  name_prefix = \"${var.project_name}-alb-\"\n  vpc_id      = var.vpc_id\n\n  ingress {\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    from_port   = 443\n    to_port     = 443\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = \"${var.project_name}-alb-sg\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_260", "ruleIndex": 31, "level": "error", "attachments": [], "message": {"text": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/security/main.tf"}, "region": {"startLine": 62, "endLine": 90, "snippet": {"text": "resource \"aws_security_group\" \"alb\" {\n  name_prefix = \"${var.project_name}-alb-\"\n  vpc_id      = var.vpc_id\n\n  ingress {\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    from_port   = 443\n    to_port     = 443\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = \"${var.project_name}-alb-sg\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_7", "ruleIndex": 32, "level": "error", "attachments": [], "message": {"text": "Ensure rotation for customer created CMKs is enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/security/main.tf"}, "region": {"startLine": 93, "endLine": 100, "snippet": {"text": "resource \"aws_kms_key\" \"main\" {\n  description             = \"KMS key for ${var.project_name}\"\n  deletion_window_in_days = 7\n\n  tags = {\n    Name = \"${var.project_name}-kms-key\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_28", "ruleIndex": 14, "level": "error", "attachments": [], "message": {"text": "Ensure DynamoDB point in time recovery (backup) is enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/serverless/main.tf"}, "region": {"startLine": 30, "endLine": 43, "snippet": {"text": "resource \"aws_dynamodb_table\" \"main\" {\n  name         = \"${var.project_name}-table\"\n  billing_mode = \"PAY_PER_REQUEST\"\n  hash_key     = \"id\"\n\n  attribute {\n    name = \"id\"\n    type = \"S\"\n  }\n\n  tags = {\n    Name = \"${var.project_name}-dynamodb-table\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_119", "ruleIndex": 15, "level": "error", "attachments": [], "message": {"text": "Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/serverless/main.tf"}, "region": {"startLine": 30, "endLine": 43, "snippet": {"text": "resource \"aws_dynamodb_table\" \"main\" {\n  name         = \"${var.project_name}-table\"\n  billing_mode = \"PAY_PER_REQUEST\"\n  hash_key     = \"id\"\n\n  attribute {\n    name = \"id\"\n    type = \"S\"\n  }\n\n  tags = {\n    Name = \"${var.project_name}-dynamodb-table\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_363", "ruleIndex": 33, "level": "error", "attachments": [], "message": {"text": "Ensure Lambda Runtime is not deprecated"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/serverless/main.tf"}, "region": {"startLine": 46, "endLine": 71, "snippet": {"text": "resource \"aws_lambda_function\" \"main\" {\n  filename      = \"lambda_function.zip\"\n  function_name = \"${var.project_name}-function\"\n  role          = var.lambda_role_arn\n  handler       = \"index.handler\"\n  runtime       = \"python3.9\"\n  timeout       = 30\n\n  vpc_config {\n    subnet_ids         = var.private_subnet_ids\n    security_group_ids = [aws_security_group.lambda.id]\n  }\n\n  tracing_config {\n    mode = \"Active\"\n  }\n\n  environment {\n    variables = {\n      DYNAMODB_TABLE = aws_dynamodb_table.main.name\n      S3_BUCKET      = aws_s3_bucket.lambda_bucket.bucket\n    }\n  }\n\n  depends_on = [data.archive_file.lambda_zip]\n}\n"}}}}]}, {"ruleId": "CKV_AWS_272", "ruleIndex": 18, "level": "error", "attachments": [], "message": {"text": "Ensure AWS Lambda function is configured to validate code-signing"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/serverless/main.tf"}, "region": {"startLine": 46, "endLine": 71, "snippet": {"text": "resource \"aws_lambda_function\" \"main\" {\n  filename      = \"lambda_function.zip\"\n  function_name = \"${var.project_name}-function\"\n  role          = var.lambda_role_arn\n  handler       = \"index.handler\"\n  runtime       = \"python3.9\"\n  timeout       = 30\n\n  vpc_config {\n    subnet_ids         = var.private_subnet_ids\n    security_group_ids = [aws_security_group.lambda.id]\n  }\n\n  tracing_config {\n    mode = \"Active\"\n  }\n\n  environment {\n    variables = {\n      DYNAMODB_TABLE = aws_dynamodb_table.main.name\n      S3_BUCKET      = aws_s3_bucket.lambda_bucket.bucket\n    }\n  }\n\n  depends_on = [data.archive_file.lambda_zip]\n}\n"}}}}]}, {"ruleId": "CKV_AWS_116", "ruleIndex": 19, "level": "error", "attachments": [], "message": {"text": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/serverless/main.tf"}, "region": {"startLine": 46, "endLine": 71, "snippet": {"text": "resource \"aws_lambda_function\" \"main\" {\n  filename      = \"lambda_function.zip\"\n  function_name = \"${var.project_name}-function\"\n  role          = var.lambda_role_arn\n  handler       = \"index.handler\"\n  runtime       = \"python3.9\"\n  timeout       = 30\n\n  vpc_config {\n    subnet_ids         = var.private_subnet_ids\n    security_group_ids = [aws_security_group.lambda.id]\n  }\n\n  tracing_config {\n    mode = \"Active\"\n  }\n\n  environment {\n    variables = {\n      DYNAMODB_TABLE = aws_dynamodb_table.main.name\n      S3_BUCKET      = aws_s3_bucket.lambda_bucket.bucket\n    }\n  }\n\n  depends_on = [data.archive_file.lambda_zip]\n}\n"}}}}]}, {"ruleId": "CKV_AWS_173", "ruleIndex": 20, "level": "error", "attachments": [], "message": {"text": "Check encryption settings for Lambda environmental variable"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/serverless/main.tf"}, "region": {"startLine": 46, "endLine": 71, "snippet": {"text": "resource \"aws_lambda_function\" \"main\" {\n  filename      = \"lambda_function.zip\"\n  function_name = \"${var.project_name}-function\"\n  role          = var.lambda_role_arn\n  handler       = \"index.handler\"\n  runtime       = \"python3.9\"\n  timeout       = 30\n\n  vpc_config {\n    subnet_ids         = var.private_subnet_ids\n    security_group_ids = [aws_security_group.lambda.id]\n  }\n\n  tracing_config {\n    mode = \"Active\"\n  }\n\n  environment {\n    variables = {\n      DYNAMODB_TABLE = aws_dynamodb_table.main.name\n      S3_BUCKET      = aws_s3_bucket.lambda_bucket.bucket\n    }\n  }\n\n  depends_on = [data.archive_file.lambda_zip]\n}\n"}}}}]}, {"ruleId": "CKV_AWS_115", "ruleIndex": 21, "level": "error", "attachments": [], "message": {"text": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/serverless/main.tf"}, "region": {"startLine": 46, "endLine": 71, "snippet": {"text": "resource \"aws_lambda_function\" \"main\" {\n  filename      = \"lambda_function.zip\"\n  function_name = \"${var.project_name}-function\"\n  role          = var.lambda_role_arn\n  handler       = \"index.handler\"\n  runtime       = \"python3.9\"\n  timeout       = 30\n\n  vpc_config {\n    subnet_ids         = var.private_subnet_ids\n    security_group_ids = [aws_security_group.lambda.id]\n  }\n\n  tracing_config {\n    mode = \"Active\"\n  }\n\n  environment {\n    variables = {\n      DYNAMODB_TABLE = aws_dynamodb_table.main.name\n      S3_BUCKET      = aws_s3_bucket.lambda_bucket.bucket\n    }\n  }\n\n  depends_on = [data.archive_file.lambda_zip]\n}\n"}}}}]}, {"ruleId": "CKV_AWS_23", "ruleIndex": 2, "level": "error", "attachments": [], "message": {"text": "Ensure every security group and rule has a description"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/serverless/main.tf"}, "region": {"startLine": 74, "endLine": 88, "snippet": {"text": "resource \"aws_security_group\" \"lambda\" {\n  name_prefix = \"${var.project_name}-lambda-\"\n  vpc_id      = var.vpc_id\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = \"${var.project_name}-lambda-sg\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_382", "ruleIndex": 3, "level": "error", "attachments": [], "message": {"text": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/serverless/main.tf"}, "region": {"startLine": 74, "endLine": 88, "snippet": {"text": "resource \"aws_security_group\" \"lambda\" {\n  name_prefix = \"${var.project_name}-lambda-\"\n  vpc_id      = var.vpc_id\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = \"${var.project_name}-lambda-sg\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_237", "ruleIndex": 34, "level": "error", "attachments": [], "message": {"text": "Ensure Create before destroy for API Gateway"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/serverless/main.tf"}, "region": {"startLine": 122, "endLine": 124, "snippet": {"text": "resource \"aws_api_gateway_rest_api\" \"main\" {\n  name = \"${var.project_name}-api\"\n}\n"}}}}]}, {"ruleId": "CKV_AWS_59", "ruleIndex": 35, "level": "error", "attachments": [], "message": {"text": "Ensure there is no open access to back-end resources through API"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/serverless/main.tf"}, "region": {"startLine": 132, "endLine": 137, "snippet": {"text": "resource \"aws_api_gateway_method\" \"proxy\" {\n  rest_api_id   = aws_api_gateway_rest_api.main.id\n  resource_id   = aws_api_gateway_resource.proxy.id\n  http_method   = \"ANY\"\n  authorization = \"NONE\"\n}\n"}}}}]}, {"ruleId": "CKV_AWS_217", "ruleIndex": 36, "level": "error", "attachments": [], "message": {"text": "Ensure Create before destroy for API deployments"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/serverless/main.tf"}, "region": {"startLine": 149, "endLine": 153, "snippet": {"text": "resource \"aws_api_gateway_deployment\" \"main\" {\n  depends_on = [aws_api_gateway_integration.lambda]\n\n  rest_api_id = aws_api_gateway_rest_api.main.id\n}\n"}}}}]}, {"ruleId": "CKV_AWS_76", "ruleIndex": 37, "level": "error", "attachments": [], "message": {"text": "Ensure API Gateway has Access Logging enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/serverless/main.tf"}, "region": {"startLine": 155, "endLine": 159, "snippet": {"text": "resource \"aws_api_gateway_stage\" \"main\" {\n  deployment_id = aws_api_gateway_deployment.main.id\n  rest_api_id   = aws_api_gateway_rest_api.main.id\n  stage_name    = \"dev\"\n}\n"}}}}]}, {"ruleId": "CKV_AWS_120", "ruleIndex": 38, "level": "error", "attachments": [], "message": {"text": "Ensure API Gateway caching is enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/serverless/main.tf"}, "region": {"startLine": 155, "endLine": 159, "snippet": {"text": "resource \"aws_api_gateway_stage\" \"main\" {\n  deployment_id = aws_api_gateway_deployment.main.id\n  rest_api_id   = aws_api_gateway_rest_api.main.id\n  stage_name    = \"dev\"\n}\n"}}}}]}, {"ruleId": "CKV_AWS_73", "ruleIndex": 39, "level": "error", "attachments": [], "message": {"text": "Ensure API Gateway has X-Ray Tracing enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/serverless/main.tf"}, "region": {"startLine": 155, "endLine": 159, "snippet": {"text": "resource \"aws_api_gateway_stage\" \"main\" {\n  deployment_id = aws_api_gateway_deployment.main.id\n  rest_api_id   = aws_api_gateway_rest_api.main.id\n  stage_name    = \"dev\"\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_51", "ruleIndex": 40, "level": "error", "attachments": [], "message": {"text": "Ensure AWS API Gateway endpoints uses client certificate authentication"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/serverless/main.tf"}, "region": {"startLine": 155, "endLine": 159, "snippet": {"text": "resource \"aws_api_gateway_stage\" \"main\" {\n  deployment_id = aws_api_gateway_deployment.main.id\n  rest_api_id   = aws_api_gateway_rest_api.main.id\n  stage_name    = \"dev\"\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_53", "ruleIndex": 41, "level": "error", "attachments": [], "message": {"text": "Ensure AWS API gateway request is validated"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/serverless/main.tf"}, "region": {"startLine": 132, "endLine": 137, "snippet": {"text": "resource \"aws_api_gateway_method\" \"proxy\" {\n  rest_api_id   = aws_api_gateway_rest_api.main.id\n  resource_id   = aws_api_gateway_resource.proxy.id\n  http_method   = \"ANY\"\n  authorization = \"NONE\"\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_4", "ruleIndex": 42, "level": "error", "attachments": [], "message": {"text": "Ensure API Gateway stage have logging level defined as appropriate"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/serverless/main.tf"}, "region": {"startLine": 155, "endLine": 159, "snippet": {"text": "resource \"aws_api_gateway_stage\" \"main\" {\n  deployment_id = aws_api_gateway_deployment.main.id\n  rest_api_id   = aws_api_gateway_rest_api.main.id\n  stage_name    = \"dev\"\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_29", "ruleIndex": 43, "level": "error", "attachments": [], "message": {"text": "Ensure public API gateway are protected by WAF"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/serverless/main.tf"}, "region": {"startLine": 155, "endLine": 159, "snippet": {"text": "resource \"aws_api_gateway_stage\" \"main\" {\n  deployment_id = aws_api_gateway_deployment.main.id\n  rest_api_id   = aws_api_gateway_rest_api.main.id\n  stage_name    = \"dev\"\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_37", "ruleIndex": 44, "level": "error", "attachments": [], "message": {"text": "Ensure CodeCommit associates an approval rule"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/cicd/main.tf"}, "region": {"startLine": 20, "endLine": 23, "snippet": {"text": "resource \"aws_codecommit_repository\" \"main\" {\n  repository_name = \"${var.project_name}-repo\"\n  description     = \"Repository for ${var.project_name}\"\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_18", "ruleIndex": 45, "level": "error", "attachments": [], "message": {"text": "Ensure that Elastic File System (Amazon EFS) file systems are added in the backup plans of AWS Backup"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/observability/main.tf"}, "region": {"startLine": 12, "endLine": 19, "snippet": {"text": "resource \"aws_efs_file_system\" \"observability\" {\n  creation_token = \"${var.project_name}-observability-efs\"\n  encrypted      = true\n\n  tags = {\n    Name = \"${var.project_name}-observability-efs\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_10", "ruleIndex": 46, "level": "error", "attachments": [], "message": {"text": "Ensure CloudTrail trails are integrated with CloudWatch Logs"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/monitoring/main.tf"}, "region": {"startLine": 92, "endLine": 106, "snippet": {"text": "resource \"aws_cloudtrail\" \"main\" {\n  name           = \"${var.project_name}-trail\"\n  s3_bucket_name = aws_s3_bucket.cloudtrail.bucket\n\n  event_selector {\n    read_write_type                  = \"All\"\n    include_management_events        = true\n    exclude_management_event_sources = []\n\n    data_resource {\n      type   = \"AWS::S3::Object\"\n      values = [\"arn:aws:s3:::*/*\"]\n    }\n  }\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_60", "ruleIndex": 47, "level": "error", "attachments": [], "message": {"text": "Ensure RDS instance with copy tags to snapshots is enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/main.tf"}, "region": {"startLine": 78, "endLine": 122, "snippet": {"text": "resource \"aws_db_instance\" \"main\" {\n  identifier = \"${var.project_name}-database\"\n\n  allocated_storage     = 20\n  max_allocated_storage = 100\n  storage_type          = \"gp2\"\n  storage_encrypted     = true\n  kms_key_id            = var.kms_key_arn\n\n  engine                     = \"mysql\"\n  engine_version             = \"8.0\"\n  instance_class             = \"db.t3.micro\"\n  auto_minor_version_upgrade = true\n\n  db_name  = \"learningdb\"\n  username = \"admin\"\n  password = \"changeme123!\" # Use AWS Secrets Manager in production\n\n  vpc_security_group_ids = [aws_security_group.rds.id]\n  db_subnet_group_name   = aws_db_subnet_group.main.name\n\n  multi_az                = true\n  backup_retention_period = 7\n  backup_window           = \"03:00-04:00\"\n  maintenance_window      = \"sun:04:00-sun:05:00\"\n\n  monitoring_interval = 60\n  monitoring_role_arn = aws_iam_role.rds_enhanced_monitoring.arn\n\n  iam_database_authentication_enabled = true\n\n  enabled_cloudwatch_logs_exports = [\n    \"error\",\n    \"general\",\n    \"slowquery\"\n  ]\n\n  skip_final_snapshot = true\n  deletion_protection = true\n\n  tags = {\n    Name        = \"${var.project_name}-database\"\n    Environment = \"learning\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_60", "ruleIndex": 47, "level": "error", "attachments": [], "message": {"text": "Ensure RDS instance with copy tags to snapshots is enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 192, "endLine": 212, "snippet": {"text": "resource \"aws_db_instance\" \"dr_replica\" {\n  provider                   = aws.dr_region\n  identifier                 = \"${var.project_name}-dr-database\"\n  replicate_source_db        = aws_db_instance.main.arn\n  instance_class             = \"db.t3.micro\" # Smaller instance for cost efficiency\n  vpc_security_group_ids     = [aws_security_group.dr_rds.id]\n  db_subnet_group_name       = aws_db_subnet_group.dr.name\n  skip_final_snapshot        = true\n  auto_minor_version_upgrade = true\n\n  # For a pilot light setup, consider:\n  multi_az                = false # Can be true for higher DR reliability\n  backup_retention_period = 5     # Fewer days than primary \n\n  tags = {\n    Name        = \"${var.project_name}-dr-database\"\n    Environment = \"dr\"\n  }\n\n  depends_on = [aws_db_instance.main]\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_62", "ruleIndex": 48, "level": "error", "attachments": [], "message": {"text": "Ensure S3 buckets should have event notifications enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/cicd/main.tf"}, "region": {"startLine": 2, "endLine": 4, "snippet": {"text": "resource \"aws_s3_bucket\" \"codepipeline_artifacts\" {\n  bucket = \"${var.project_name}-codepipeline-${random_string.bucket_suffix.result}\"\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_62", "ruleIndex": 48, "level": "error", "attachments": [], "message": {"text": "Ensure S3 buckets should have event notifications enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 219, "endLine": 227, "snippet": {"text": "resource \"aws_s3_bucket\" \"dr\" {\n  provider      = aws.dr_region\n  bucket        = \"${var.project_name}-dr-data-${var.aws_account_id}\"\n  force_destroy = true\n\n  tags = {\n    Name = \"${var.project_name}-dr-data\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_62", "ruleIndex": 48, "level": "error", "attachments": [], "message": {"text": "Ensure S3 buckets should have event notifications enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 312, "endLine": 319, "snippet": {"text": "resource \"aws_s3_bucket\" \"primary\" {\n  bucket        = \"${var.project_name}-data-${var.aws_account_id}\"\n  force_destroy = true\n\n  tags = {\n    Name = \"${var.project_name}-data\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_62", "ruleIndex": 48, "level": "error", "attachments": [], "message": {"text": "Ensure S3 buckets should have event notifications enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/event-systems/main.tf"}, "region": {"startLine": 56, "endLine": 58, "snippet": {"text": "resource \"aws_s3_bucket\" \"firehose_bucket\" {\n  bucket = \"${var.project_name}-firehose-${random_string.bucket_suffix.result}\"\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_62", "ruleIndex": 48, "level": "error", "attachments": [], "message": {"text": "Ensure S3 buckets should have event notifications enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/monitoring/main.tf"}, "region": {"startLine": 109, "endLine": 112, "snippet": {"text": "resource \"aws_s3_bucket\" \"cloudtrail\" {\n  bucket        = \"${var.project_name}-cloudtrail-${random_string.bucket_suffix.result}\"\n  force_destroy = true\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_62", "ruleIndex": 48, "level": "error", "attachments": [], "message": {"text": "Ensure S3 buckets should have event notifications enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/serverless/main.tf"}, "region": {"startLine": 2, "endLine": 4, "snippet": {"text": "resource \"aws_s3_bucket\" \"lambda_bucket\" {\n  bucket = \"${var.project_name}-lambda-${random_string.bucket_suffix.result}\"\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_6", "ruleIndex": 49, "level": "error", "attachments": [], "message": {"text": "Ensure that S3 bucket has a Public Access block"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/cicd/main.tf"}, "region": {"startLine": 2, "endLine": 4, "snippet": {"text": "resource \"aws_s3_bucket\" \"codepipeline_artifacts\" {\n  bucket = \"${var.project_name}-codepipeline-${random_string.bucket_suffix.result}\"\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_6", "ruleIndex": 49, "level": "error", "attachments": [], "message": {"text": "Ensure that S3 bucket has a Public Access block"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 219, "endLine": 227, "snippet": {"text": "resource \"aws_s3_bucket\" \"dr\" {\n  provider      = aws.dr_region\n  bucket        = \"${var.project_name}-dr-data-${var.aws_account_id}\"\n  force_destroy = true\n\n  tags = {\n    Name = \"${var.project_name}-dr-data\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_6", "ruleIndex": 49, "level": "error", "attachments": [], "message": {"text": "Ensure that S3 bucket has a Public Access block"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 312, "endLine": 319, "snippet": {"text": "resource \"aws_s3_bucket\" \"primary\" {\n  bucket        = \"${var.project_name}-data-${var.aws_account_id}\"\n  force_destroy = true\n\n  tags = {\n    Name = \"${var.project_name}-data\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_6", "ruleIndex": 49, "level": "error", "attachments": [], "message": {"text": "Ensure that S3 bucket has a Public Access block"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/event-systems/main.tf"}, "region": {"startLine": 56, "endLine": 58, "snippet": {"text": "resource \"aws_s3_bucket\" \"firehose_bucket\" {\n  bucket = \"${var.project_name}-firehose-${random_string.bucket_suffix.result}\"\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_6", "ruleIndex": 49, "level": "error", "attachments": [], "message": {"text": "Ensure that S3 bucket has a Public Access block"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/monitoring/main.tf"}, "region": {"startLine": 109, "endLine": 112, "snippet": {"text": "resource \"aws_s3_bucket\" \"cloudtrail\" {\n  bucket        = \"${var.project_name}-cloudtrail-${random_string.bucket_suffix.result}\"\n  force_destroy = true\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_6", "ruleIndex": 49, "level": "error", "attachments": [], "message": {"text": "Ensure that S3 bucket has a Public Access block"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/serverless/main.tf"}, "region": {"startLine": 2, "endLine": 4, "snippet": {"text": "resource \"aws_s3_bucket\" \"lambda_bucket\" {\n  bucket = \"${var.project_name}-lambda-${random_string.bucket_suffix.result}\"\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_61", "ruleIndex": 50, "level": "error", "attachments": [], "message": {"text": "Ensure that an S3 bucket has a lifecycle configuration"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/cicd/main.tf"}, "region": {"startLine": 2, "endLine": 4, "snippet": {"text": "resource \"aws_s3_bucket\" \"codepipeline_artifacts\" {\n  bucket = \"${var.project_name}-codepipeline-${random_string.bucket_suffix.result}\"\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_61", "ruleIndex": 50, "level": "error", "attachments": [], "message": {"text": "Ensure that an S3 bucket has a lifecycle configuration"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 219, "endLine": 227, "snippet": {"text": "resource \"aws_s3_bucket\" \"dr\" {\n  provider      = aws.dr_region\n  bucket        = \"${var.project_name}-dr-data-${var.aws_account_id}\"\n  force_destroy = true\n\n  tags = {\n    Name = \"${var.project_name}-dr-data\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_61", "ruleIndex": 50, "level": "error", "attachments": [], "message": {"text": "Ensure that an S3 bucket has a lifecycle configuration"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 312, "endLine": 319, "snippet": {"text": "resource \"aws_s3_bucket\" \"primary\" {\n  bucket        = \"${var.project_name}-data-${var.aws_account_id}\"\n  force_destroy = true\n\n  tags = {\n    Name = \"${var.project_name}-data\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_61", "ruleIndex": 50, "level": "error", "attachments": [], "message": {"text": "Ensure that an S3 bucket has a lifecycle configuration"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/event-systems/main.tf"}, "region": {"startLine": 56, "endLine": 58, "snippet": {"text": "resource \"aws_s3_bucket\" \"firehose_bucket\" {\n  bucket = \"${var.project_name}-firehose-${random_string.bucket_suffix.result}\"\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_61", "ruleIndex": 50, "level": "error", "attachments": [], "message": {"text": "Ensure that an S3 bucket has a lifecycle configuration"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/serverless/main.tf"}, "region": {"startLine": 2, "endLine": 4, "snippet": {"text": "resource \"aws_s3_bucket\" \"lambda_bucket\" {\n  bucket = \"${var.project_name}-lambda-${random_string.bucket_suffix.result}\"\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_61", "ruleIndex": 50, "level": "error", "attachments": [], "message": {"text": "Ensure that an S3 bucket has a lifecycle configuration"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/monitoring/main.tf"}, "region": {"startLine": 109, "endLine": 112, "snippet": {"text": "resource \"aws_s3_bucket\" \"cloudtrail\" {\n  bucket        = \"${var.project_name}-cloudtrail-${random_string.bucket_suffix.result}\"\n  force_destroy = true\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_64", "ruleIndex": 51, "level": "error", "attachments": [], "message": {"text": "Ensure KMS key Policy is defined"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/cicd/main.tf"}, "region": {"startLine": 26, "endLine": 29, "snippet": {"text": "resource \"aws_kms_key\" \"codebuild\" {\n  description         = \"KMS key for CodeBuild project encryption\"\n  enable_key_rotation = true\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_64", "ruleIndex": 51, "level": "error", "attachments": [], "message": {"text": "Ensure KMS key Policy is defined"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/cicd/main.tf"}, "region": {"startLine": 76, "endLine": 79, "snippet": {"text": "resource \"aws_kms_key\" \"codepipeline\" {\n  description         = \"KMS key for CodePipeline artifact encryption\"\n  enable_key_rotation = true\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_64", "ruleIndex": 51, "level": "error", "attachments": [], "message": {"text": "Ensure KMS key Policy is defined"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/containers/main.tf"}, "region": {"startLine": 2, "endLine": 5, "snippet": {"text": "resource \"aws_kms_key\" \"logs\" {\n  description         = \"KMS key for CloudWatch logs encryption\"\n  enable_key_rotation = true\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_64", "ruleIndex": 51, "level": "error", "attachments": [], "message": {"text": "Ensure KMS key Policy is defined"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 428, "endLine": 432, "snippet": {"text": "resource \"aws_kms_key\" \"dr_logs\" {\n  provider            = aws.dr_region\n  description         = \"DR KMS key for CloudWatch logs encryption\"\n  enable_key_rotation = true\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_64", "ruleIndex": 51, "level": "error", "attachments": [], "message": {"text": "Ensure KMS key Policy is defined"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/event-systems/main.tf"}, "region": {"startLine": 2, "endLine": 5, "snippet": {"text": "resource \"aws_kms_key\" \"events\" {\n  description         = \"KMS key for event systems encryption\"\n  enable_key_rotation = true\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_64", "ruleIndex": 51, "level": "error", "attachments": [], "message": {"text": "Ensure KMS key Policy is defined"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/security/main.tf"}, "region": {"startLine": 93, "endLine": 100, "snippet": {"text": "resource \"aws_kms_key\" \"main\" {\n  description             = \"KMS key for ${var.project_name}\"\n  deletion_window_in_days = 7\n\n  tags = {\n    Name = \"${var.project_name}-kms-key\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_18", "ruleIndex": 52, "level": "error", "attachments": [], "message": {"text": "Ensure the S3 bucket has access logging enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/cicd/main.tf"}, "region": {"startLine": 2, "endLine": 4, "snippet": {"text": "resource \"aws_s3_bucket\" \"codepipeline_artifacts\" {\n  bucket = \"${var.project_name}-codepipeline-${random_string.bucket_suffix.result}\"\n}\n"}}}}]}, {"ruleId": "CKV_AWS_18", "ruleIndex": 52, "level": "error", "attachments": [], "message": {"text": "Ensure the S3 bucket has access logging enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 219, "endLine": 227, "snippet": {"text": "resource \"aws_s3_bucket\" \"dr\" {\n  provider      = aws.dr_region\n  bucket        = \"${var.project_name}-dr-data-${var.aws_account_id}\"\n  force_destroy = true\n\n  tags = {\n    Name = \"${var.project_name}-dr-data\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_18", "ruleIndex": 52, "level": "error", "attachments": [], "message": {"text": "Ensure the S3 bucket has access logging enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 312, "endLine": 319, "snippet": {"text": "resource \"aws_s3_bucket\" \"primary\" {\n  bucket        = \"${var.project_name}-data-${var.aws_account_id}\"\n  force_destroy = true\n\n  tags = {\n    Name = \"${var.project_name}-data\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_18", "ruleIndex": 52, "level": "error", "attachments": [], "message": {"text": "Ensure the S3 bucket has access logging enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/event-systems/main.tf"}, "region": {"startLine": 56, "endLine": 58, "snippet": {"text": "resource \"aws_s3_bucket\" \"firehose_bucket\" {\n  bucket = \"${var.project_name}-firehose-${random_string.bucket_suffix.result}\"\n}\n"}}}}]}, {"ruleId": "CKV_AWS_18", "ruleIndex": 52, "level": "error", "attachments": [], "message": {"text": "Ensure the S3 bucket has access logging enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/monitoring/main.tf"}, "region": {"startLine": 109, "endLine": 112, "snippet": {"text": "resource \"aws_s3_bucket\" \"cloudtrail\" {\n  bucket        = \"${var.project_name}-cloudtrail-${random_string.bucket_suffix.result}\"\n  force_destroy = true\n}\n"}}}}]}, {"ruleId": "CKV_AWS_18", "ruleIndex": 52, "level": "error", "attachments": [], "message": {"text": "Ensure the S3 bucket has access logging enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/serverless/main.tf"}, "region": {"startLine": 2, "endLine": 4, "snippet": {"text": "resource \"aws_s3_bucket\" \"lambda_bucket\" {\n  bucket = \"${var.project_name}-lambda-${random_string.bucket_suffix.result}\"\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_57", "ruleIndex": 53, "level": "error", "attachments": [], "message": {"text": "Ensure Secrets Manager secrets should have automatic rotation enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/secrets/main.tf"}, "region": {"startLine": 2, "endLine": 9, "snippet": {"text": "resource \"aws_secretsmanager_secret\" \"rancher_password\" {\n  name        = \"${var.project_name}-rancher-password\"\n  description = \"Bootstrap password for Rancher management\"\n\n  tags = {\n    Name = \"${var.project_name}-rancher-password\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_57", "ruleIndex": 53, "level": "error", "attachments": [], "message": {"text": "Ensure Secrets Manager secrets should have automatic rotation enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/secrets/main.tf"}, "region": {"startLine": 16, "endLine": 23, "snippet": {"text": "resource \"aws_secretsmanager_secret\" \"grafana_password\" {\n  name        = \"${var.project_name}-grafana-password\"\n  description = \"Admin password for Grafana\"\n\n  tags = {\n    Name = \"${var.project_name}-grafana-password\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_57", "ruleIndex": 53, "level": "error", "attachments": [], "message": {"text": "Ensure Secrets Manager secrets should have automatic rotation enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/secrets/main.tf"}, "region": {"startLine": 30, "endLine": 37, "snippet": {"text": "resource \"aws_secretsmanager_secret\" \"rds_password\" {\n  name        = \"${var.project_name}-rds-password\"\n  description = \"Master password for RDS database\"\n\n  tags = {\n    Name = \"${var.project_name}-rds-password\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_5", "ruleIndex": 54, "level": "error", "attachments": [], "message": {"text": "Ensure that Security Groups are attached to another resource"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/security/main.tf"}, "region": {"startLine": 2, "endLine": 30, "snippet": {"text": "resource \"aws_security_group\" \"web\" {\n  name_prefix = \"${var.project_name}-web-\"\n  vpc_id      = var.vpc_id\n\n  ingress {\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    from_port   = 443\n    to_port     = 443\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = \"${var.project_name}-web-sg\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_5", "ruleIndex": 54, "level": "error", "attachments": [], "message": {"text": "Ensure that Security Groups are attached to another resource"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/security/main.tf"}, "region": {"startLine": 32, "endLine": 60, "snippet": {"text": "resource \"aws_security_group\" \"eks\" {\n  name_prefix = \"${var.project_name}-eks-\"\n  vpc_id      = var.vpc_id\n\n  ingress {\n    from_port = 443\n    to_port   = 443\n    protocol  = \"tcp\"\n    self      = true\n  }\n\n  ingress {\n    from_port   = 1025\n    to_port     = 65535\n    protocol    = \"tcp\"\n    cidr_blocks = [\"10.0.0.0/8\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = \"${var.project_name}-eks-sg\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_5", "ruleIndex": 54, "level": "error", "attachments": [], "message": {"text": "Ensure that Security Groups are attached to another resource"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/security/main.tf"}, "region": {"startLine": 62, "endLine": 90, "snippet": {"text": "resource \"aws_security_group\" \"alb\" {\n  name_prefix = \"${var.project_name}-alb-\"\n  vpc_id      = var.vpc_id\n\n  ingress {\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    from_port   = 443\n    to_port     = 443\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = \"${var.project_name}-alb-sg\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_11", "ruleIndex": 55, "level": "error", "attachments": [], "message": {"text": "Ensure VPC flow logging is enabled in all VPCs"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 32, "endLine": 41, "snippet": {"text": "resource \"aws_vpc\" \"dr\" {\n  provider             = aws.dr_region\n  cidr_block           = var.dr_vpc_cidr\n  enable_dns_hostnames = true\n  enable_dns_support   = true\n\n  tags = {\n    Name = \"${var.project_name}-dr-vpc\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_11", "ruleIndex": 55, "level": "error", "attachments": [], "message": {"text": "Ensure VPC flow logging is enabled in all VPCs"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/networking/main.tf"}, "region": {"startLine": 2, "endLine": 10, "snippet": {"text": "resource \"aws_vpc\" \"main\" {\n  cidr_block           = var.vpc_cidr\n  enable_dns_hostnames = true\n  enable_dns_support   = true\n\n  tags = {\n    Name = \"${var.project_name}-vpc\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_12", "ruleIndex": 56, "level": "error", "attachments": [], "message": {"text": "Ensure the default security group of every VPC restricts all traffic"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 32, "endLine": 41, "snippet": {"text": "resource \"aws_vpc\" \"dr\" {\n  provider             = aws.dr_region\n  cidr_block           = var.dr_vpc_cidr\n  enable_dns_hostnames = true\n  enable_dns_support   = true\n\n  tags = {\n    Name = \"${var.project_name}-dr-vpc\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_12", "ruleIndex": 56, "level": "error", "attachments": [], "message": {"text": "Ensure the default security group of every VPC restricts all traffic"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/networking/main.tf"}, "region": {"startLine": 2, "endLine": 10, "snippet": {"text": "resource \"aws_vpc\" \"main\" {\n  cidr_block           = var.vpc_cidr\n  enable_dns_hostnames = true\n  enable_dns_support   = true\n\n  tags = {\n    Name = \"${var.project_name}-vpc\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_1", "ruleIndex": 57, "level": "error", "attachments": [], "message": {"text": "Ensure that all NACL are attached to subnets"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/networking/main.tf"}, "region": {"startLine": 239, "endLine": 263, "snippet": {"text": "resource \"aws_network_acl\" \"private\" {\n  vpc_id = aws_vpc.main.id\n\n  egress {\n    protocol   = \"-1\"\n    rule_no    = 100\n    action     = \"allow\"\n    cidr_block = \"0.0.0.0/0\"\n    from_port  = 0\n    to_port    = 0\n  }\n\n  ingress {\n    protocol   = \"-1\"\n    rule_no    = 100\n    action     = \"allow\"\n    cidr_block = var.vpc_cidr\n    from_port  = 0\n    to_port    = 0\n  }\n\n  tags = {\n    Name = \"${var.project_name}-private-nacl\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_31", "ruleIndex": 58, "level": "error", "attachments": [], "message": {"text": "Ensure WAF2 has a Logging Configuration"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/security/main.tf"}, "region": {"startLine": 138, "endLine": 199, "snippet": {"text": "resource \"aws_wafv2_web_acl\" \"main\" {\n  name  = \"${var.project_name}-waf\"\n  scope = \"REGIONAL\"\n\n  default_action {\n    allow {}\n  }\n\n  rule {\n    name     = \"AWSManagedRulesCommonRuleSet\"\n    priority = 1\n\n    override_action {\n      none {}\n    }\n\n    statement {\n      managed_rule_group_statement {\n        name        = \"AWSManagedRulesCommonRuleSet\"\n        vendor_name = \"AWS\"\n      }\n    }\n\n    visibility_config {\n      cloudwatch_metrics_enabled = false\n      metric_name                = \"CommonRuleSetMetric\"\n      sampled_requests_enabled   = false\n    }\n  }\n\n  rule {\n    name     = \"AWSManagedRulesKnownBadInputsRuleSet\"\n    priority = 2\n\n    override_action {\n      none {}\n    }\n\n    statement {\n      managed_rule_group_statement {\n        name        = \"AWSManagedRulesKnownBadInputsRuleSet\"\n        vendor_name = \"AWS\"\n      }\n    }\n\n    visibility_config {\n      cloudwatch_metrics_enabled = false\n      metric_name                = \"KnownBadInputsRuleSetMetric\"\n      sampled_requests_enabled   = false\n    }\n  }\n\n  tags = {\n    Name = \"${var.project_name}-waf\"\n  }\n\n  visibility_config {\n    cloudwatch_metrics_enabled = false\n    metric_name                = \"${var.project_name}WAF\"\n    sampled_requests_enabled   = false\n  }\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_23", "ruleIndex": 59, "level": "error", "attachments": [], "message": {"text": "Route53 A Record has Attached Resource"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 385, "endLine": 402, "snippet": {"text": "resource \"aws_route53_record\" \"app_failover\" {\n  zone_id = data.aws_route53_zone.main.zone_id\n  name    = var.application_domain\n  type    = \"A\"\n\n  failover_routing_policy {\n    type = \"PRIMARY\"\n  }\n\n  health_check_id = aws_route53_health_check.primary.id\n  set_identifier  = \"primary\"\n\n  alias {\n    name                   = var.primary_endpoint_domain\n    zone_id                = var.primary_dns_zone_id\n    evaluate_target_health = true\n  }\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_23", "ruleIndex": 59, "level": "error", "attachments": [], "message": {"text": "Route53 A Record has Attached Resource"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/disaster-recovery/multi-region-dr.tf"}, "region": {"startLine": 404, "endLine": 421, "snippet": {"text": "resource \"aws_route53_record\" \"app_failover_dr\" {\n  zone_id = data.aws_route53_zone.main.zone_id\n  name    = var.application_domain\n  type    = \"A\"\n\n  failover_routing_policy {\n    type = \"SECONDARY\"\n  }\n\n  health_check_id = aws_route53_health_check.dr.id\n  set_identifier  = \"dr\"\n\n  alias {\n    name                   = var.dr_endpoint_domain\n    zone_id                = var.dr_dns_zone_id\n    evaluate_target_health = true\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_21", "ruleIndex": 60, "level": "error", "attachments": [], "message": {"text": "Ensure all data stored in the S3 bucket have versioning enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/event-systems/main.tf"}, "region": {"startLine": 56, "endLine": 58, "snippet": {"text": "resource \"aws_s3_bucket\" \"firehose_bucket\" {\n  bucket = \"${var.project_name}-firehose-${random_string.bucket_suffix.result}\"\n}\n"}}}}]}, {"ruleId": "CKV_AWS_21", "ruleIndex": 60, "level": "error", "attachments": [], "message": {"text": "Ensure all data stored in the S3 bucket have versioning enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/monitoring/main.tf"}, "region": {"startLine": 109, "endLine": 112, "snippet": {"text": "resource \"aws_s3_bucket\" \"cloudtrail\" {\n  bucket        = \"${var.project_name}-cloudtrail-${random_string.bucket_suffix.result}\"\n  force_destroy = true\n}\n"}}}}]}]}]}